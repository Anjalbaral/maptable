{"version":3,"file":"maptable.js","sources":["../src/utils.js","../src/defaultOptions.js","../src/components/Legend.js","../src/components/Watermark.js","../src/components/StackBlur.js","../src/components/solarPosition.js","../src/components/GeoMap.js","../src/components/Filters.js","../src/components/Table.js","../src/maptable.js","../src/index.js"],"sourcesContent":["function appendOptions(select, options, defaultValue) {\n  options.forEach((f) => {\n    // Filter select\n    const option = document.createElement('option');\n    option.setAttribute('value', f.value);\n    option.innerText = f.text;\n    select.appendChild(option);\n  });\n  select.value = defaultValue;\n}\n\nfunction rangeToBool(el1, range, el2) {\n  if (range === '=') {\n    return parseInt(el1, 10) === parseInt(el2, 10);\n  }\n  if (range === '≠') {\n    return parseInt(el1, 10) !== parseInt(el2, 10) && el1 !== '' && el2 !== '';\n  }\n  if (range === '>') {\n    return parseInt(el1, 10) > parseInt(el2, 10) && el1 !== '' && el2 !== '';\n  }\n  if (range === '<') {\n    return parseInt(el1, 10) < parseInt(el2, 10) && el1 !== '' && el2 !== '';\n  }\n  if (range === '≥') {\n    return parseInt(el1, 10) >= parseInt(el2, 10) && el1 !== '' && el2 !== '';\n  }\n  if (range === '≤') {\n    return parseInt(el1, 10) <= parseInt(el2, 10) && el1 !== '' && el2 !== '';\n  }\n  return true;\n}\n\n/* eslint no-loop-func: 0 */\nfunction extendRecursive() {\n  const dst = {};\n  let src;\n  const args = [].splice.call(arguments, 0);\n  const toString = {}.toString;\n\n  while (args.length > 0) {\n    src = args.splice(0, 1)[0];\n    if (toString.call(src) === '[object Object]') {\n      Object.keys(src).forEach((p) => {\n        if (toString.call(src[p]) === '[object Object]') {\n          dst[p] = extendRecursive(dst[p] || {}, src[p]);\n        } else {\n          dst[p] = src[p];\n        }\n      });\n    }\n  }\n  return dst;\n}\n\nfunction keyToTile(k) {\n  const upperK = k.charAt(0).toUpperCase() + k.slice(1);\n  return upperK.replace(/_/g, ' ');\n}\n\nfunction sanitizeKey(k) {\n  return k.toLowerCase().replace(/ /g, '_').replace(/\"/g, '').replace(/'/g, '');\n}\n\nfunction toNumber(str) {\n  if (!str || str === '') return null;\n  const resStr = str.toString().replace(/[^0-9.]+|\\s+/gim, '');\n  if (resStr !== '') return Number(resStr);\n  return null;\n}\n\nfunction quantile(array, percentile) {\n  array.sort((a, b) => a - b);\n  const index = (percentile / 100.0) * (array.length - 1);\n  let result;\n  if (Math.floor(index) === index) {\n    result = array[index];\n  } else {\n    const i = Math.floor(index);\n    const fraction = index - i;\n    result = array[i] + (array[i + 1] - array[i]) * fraction;\n  }\n  return result;\n}\n\nfunction uniqueValues(arr) {\n  if (!arr) return arr;\n  const a = [];\n  for (let i = 0, l = arr.length; i < l; i += 1) {\n    if (a.indexOf(arr[i]) === -1 && arr[i] !== '') {\n      a.push(arr[i]);\n    }\n  }\n  return a;\n}\n\nconst formatDate = (d, zone) => {\n  const newDate = new Date(d.getTime() + zone * 3600 * 1000);\n  return newDate.toISOString().split('T')[1].substr(0, 5);\n};\n\nconst isBlank = (str) => str === null || str === '' || str === undefined;\n\nconst customSortOrders = {\n  days: ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'],\n  months: ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'],\n};\n\nconst customSortAsc = (type, d1, d2, sortOrder) => {\n  const elem1 = d1.toLowerCase();\n  const elem2 = d2.toLowerCase();\n  const customSortOrder = sortOrder.length === 0 ? customSortOrders[type] || [] : sortOrder;\n  return customSortOrder.indexOf(elem1) - customSortOrder.indexOf(elem2);\n};\n\nconst customSortDesc = (type, d1, d2, sortOrder) => {\n  const elem1 = d1.toLowerCase();\n  const elem2 = d2.toLowerCase();\n  const customSortOrder = sortOrder.length === 0 ? customSortOrders[type] || [] : sortOrder;\n  return customSortOrder.indexOf(elem2) - customSortOrder.indexOf(elem1);\n};\n\nexport default {\n  rangeToBool,\n  appendOptions,\n  extendRecursive,\n  sanitizeKey,\n  toNumber,\n  keyToTile,\n  quantile,\n  uniqueValues,\n  formatDate,\n  isBlank,\n  customSortAsc,\n  customSortDesc,\n};\n","export default {\n  map: {\n    longitudeKey: 'longitude',\n    latitudeKey: 'latitude',\n    countryIdentifierKey: 'country_code',\n    countryIdentifierType: 'iso_a2',\n    zoom: true,\n    saveState: true,\n    exportSvg: null,\n    exportSvgClient: false,\n    ratioFromWidth: 0.5,\n    scaleHeight: 1.0,\n    scaleZoom: [1, 10],\n    fitContentMargin: 10,\n    autoFitContent: false,\n    tooltipClassName: 'popover bottom',\n    countries: {\n      legend: false,\n      attr: {\n        fill: '#FCFCFC',\n        stroke: '#CCC',\n        'stroke-width': 0.5,\n      },\n      tooltipClassName: 'mt-map-tooltip popover bottom',\n    },\n    heatmap: {\n      mask: true,\n      weightByAttribute: null,\n      weightByAttributeScale: 'linear',\n      circles: {\n        min: 1,\n        max: 90,\n        step: 4,\n        color: '#FF0000',\n        colorStrength: 1,\n        blur: 4.0,\n      },\n      borders: {\n        stroke: 1,\n        opacity: 0.1,\n        color: '#000',\n      },\n    },\n    markers: {\n      attr: {\n        r: 4,\n        fill: 'blue',\n        stroke: '#CCC',\n        'stroke-width': 0.5,\n      },\n      tooltipClassName: 'mt-map-tooltip popover bottom',\n    },\n    title: {\n      fontSize: 12,\n      fontFamily: 'Helevetica, Arial, Sans-Serif',\n    },\n  },\n  filters: {\n    saveState: true,\n  },\n  table: {\n    className: 'table table-striped table-bordered',\n    collapseRowsBy: [],\n  },\n};\n","export default class Legend {\n  constructor(map) {\n    this.legendWidth = 220;\n    this.map = map;\n    // Create Legend\n    this.node = this.map.svg\n      .append('g')\n      .attr('id', 'mt-map-legend')\n      .attr(\n        'transform',\n        `translate(${(this.map.getWidth() - 350)}, ${(this.map.getHeight() - 60)})`,\n      );\n\n    this.buildIndice();\n  }\n\n  buildScale(domain) {\n    const legendGradient = this.node\n      .append('defs')\n      .append('linearGradient')\n      .attr('id', 'mt-map-legend-gradient')\n      .attr('x1', '0%')\n      .attr('y1', '0%')\n      .attr('x2', '100%')\n      .attr('y2', '0%');\n\n    if (this.map.options.countries.attr.fill.minNegative\n        && this.map.options.countries.attr.fill.maxNegative) {\n      // todo - maybe watch for domain[0] < 0 && domain[1] < 0? fall back to normal min & max?\n      const midPercentNegative = Math.round(((0 - domain[0]) / (domain[1] - domain[0])) * 100);\n      const midPercentPositive = midPercentNegative + 1;\n\n      legendGradient.append('stop')\n        .attr('offset', '0%')\n        .attr('style', `stop-color:${this.map.options.countries.attr.fill.maxNegative};stop-opacity:1`);\n\n      legendGradient.append('stop')\n        .attr('offset', `${midPercentNegative}%`)\n        .attr('style', `stop-color:${this.map.options.countries.attr.fill.minNegative};stop-opacity:1`);\n      legendGradient.append('stop')\n        .attr('offset', `${midPercentPositive}%`)\n        .attr('style', `stop-color:${this.map.options.countries.attr.fill.min};stop-opacity:1`);\n    } else {\n      legendGradient.append('stop')\n        .attr('offset', '0%')\n        .attr('style', `stop-color:${this.map.options.countries.attr.fill.min};stop-opacity:1`);\n    }\n\n    legendGradient.append('stop')\n      .attr('offset', '100%')\n      .attr('style', `stop-color:${this.map.options.countries.attr.fill.max};stop-opacity:1`);\n\n    this.node.append('rect')\n      .attr('x', 30)\n      .attr('y', 0)\n      .attr('width', this.legendWidth)\n      .attr('height', 15)\n      .attr('fill', 'url(#mt-map-legend-gradient)');\n  }\n\n  buildIndice() {\n    const indice = this.node.append('g')\n      .attr('id', 'mt-map-legend-indice')\n      .attr('style', 'display:none')\n      .attr('transform', 'translate(36,15)');\n\n    indice.append('polygon')\n      .attr('points', '4.5 0 9 5 0 5')\n      .attr('fill', '#222222');\n\n    indice.append('text')\n      .attr('x', 4)\n      .attr('y', 13)\n      .attr('width', 10)\n      .attr('height', 10)\n      .attr('text-anchor', 'middle')\n      .attr('font-family', 'Arial')\n      .attr('font-size', '9')\n      .attr('stroke', '#FFFFF')\n      .attr('stroke-width', '1')\n      .attr('fill', '#222222')\n      .text('0');\n\n    this.node.append('text')\n      .attr('id', 'mt-map-legend-min')\n      .attr('x', 25)\n      .attr('y', 13)\n      .attr('width', 35)\n      .attr('height', 15)\n      .attr('text-anchor', 'end')\n      .attr('font-family', 'Arial')\n      .attr('font-size', '14')\n      .attr('stroke', '#FFFFF')\n      .attr('stroke-width', '3')\n      .attr('fill', '#222222')\n      .text('0');\n\n    this.node.append('text')\n      .attr('id', 'mt-map-legend-max')\n      .attr('y', 13)\n      .attr('x', 255)\n      .attr('width', 50)\n      .attr('height', 15)\n      .attr('text-anchor', 'start')\n      .attr('font-family', 'Arial')\n      .attr('font-size', '14')\n      .attr('stroke', '#FFFFF')\n      .attr('stroke-width', '3')\n      .attr('fill', '#222222')\n      .text('1');\n  }\n\n  updateExtents(domain) {\n    this.node.select('#mt-map-legend').style('opacity', (domain[0] === domain[1]) ? 0 : 1);\n    if (this.node.selectAll('mt-map-legend-min').length) {\n      this.node.select('#mt-map-legend-min').text(Math.round(domain[0]).toLocaleString());\n      this.node.select('#mt-map-legend-max').text(Math.round(domain[1]).toLocaleString());\n\n      // pass in the min and max (domain) to the legend\n      this.buildScale(domain);\n    }\n  }\n\n  indiceChange(val) {\n    if (Number.isNaN(val)) {\n      this.node.select('#mt-map-legend-indice')\n        .attr('style', 'display:none');\n    } else {\n      const maxValue = parseInt(this.node.select('#mt-map-legend-max').text(), 10);\n      const minValue = parseInt(this.node.select('#mt-map-legend-min').text(), 10);\n      const positionDelta = Math.round((0 - (minValue - val) / (maxValue - minValue))\n        * this.legendWidth);\n      this.node.select('#mt-map-legend-indice text').text(Math.round(val).toLocaleString());\n      this.node.select('#mt-map-legend-indice')\n        .attr('style', 'display:block')\n        .attr('transform', `translate(${(36 + positionDelta)},15)`);\n    }\n  }\n}\n","export default class Legend {\n  constructor(map, options) {\n    this.map = map;\n    this.src = options.src;\n    this.position = options.position;\n    this.width = parseInt(options.width, 10);\n    this.height = parseInt(options.height, 10);\n    this.padding = options.padding || 10;\n    this.style = options.style;\n\n    if (!options.src) {\n      console.warn('Watermak src not found');\n      return;\n    }\n    if (Number.isNaN(this.width)) {\n      console.warn('Watermak width not found');\n      return;\n    }\n    if (Number.isNaN(this.height)) {\n      console.warn('Watermak height not found');\n      return;\n    }\n\n    if (window.btoa) {\n      this.buildWatermark();\n    } else {\n      console.warn('Watermark not rendered: btoa error');\n    }\n  }\n\n  buildWatermark() {\n    d3.xhr(this.src, (res) => {\n      let mapWatermarkDelta = 0;\n      if (this.map.options.title) mapWatermarkDelta = 30;\n      let mime;\n      let x;\n      let y;\n      if (this.src.indexOf('.svg') !== -1) {\n        mime = 'image/svg+xml';\n      } else if (this.src.indexOf('.jpg') !== -1 || this.src.indexOf('.jpeg') !== -1) {\n        mime = 'image/jpeg';\n      } else if (this.src.indexOf('.png') !== -1) {\n        mime = 'image/png';\n      } else {\n        console.warn('invalid watermark mime type');\n        return;\n      }\n      const dataUri = `data:${mime};base64,${window.btoa(res.responseText)}`;\n\n      if (this.position) {\n        const pos = this.position.split(' ');\n        if (pos[0] === 'top') {\n          y = this.padding;\n        } else if (pos[0] === 'middle') {\n          y = (this.map.getHeight() - this.height) / 2;\n        } else if (pos[0] === 'bottom') {\n          y = this.map.getHeight() - this.height - this.padding - mapWatermarkDelta;\n        } else {\n          console.warn('position should be (top|middle|bottom) (left|middle|right)');\n        }\n\n        if (pos[1] === 'left') {\n          x = this.padding;\n        } else if (pos[1] === 'middle') {\n          x = (this.map.getWidth() - this.width) / 2;\n        } else if (pos[1] === 'right') {\n          x = this.map.getWidth() - this.width - this.padding;\n        } else {\n          console.warn('position should be (top|middle|bottom) (left|middle|right)');\n        }\n      }\n\n      this.node = this.map.svg\n        .append('image')\n        .attr('xlink:href', dataUri)\n        .attr('width', this.width)\n        .attr('height', this.height);\n\n      if (x && y) {\n        this.node.attr('x', x).attr('y', y);\n      }\n\n      if (this.style) {\n        this.node.attr('style', this.style);\n      }\n    });\n  }\n}\n","/* eslint-disable */\n\n/*\n    StackBlur - a fast almost Gaussian Blur For Canvas\n    Version:     0.5\n    Author:        Mario Klingemann\n    Contact:     mario@quasimondo.com\n    Website:    http://www.quasimondo.com/StackBlurForCanvas\n    Twitter:    @quasimondo\n    In case you find this class useful - especially in commercial projects -\n    I am not totally unhappy for a small donation to my PayPal account\n    mario@quasimondo.de\n    Or support me on flattr:\n    https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n    Copyright (c) 2010 Mario Klingemann\n    Permission is hereby granted, free of charge, to any person\n    obtaining a copy of this software and associated documentation\n    files (the \"Software\"), to deal in the Software without\n    restriction, including without limitation the rights to use,\n    copy, modify, merge, publish, distribute, sublicense, and/or sell\n    copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following\n    conditions:\n    The above copyright notice and this permission notice shall be\n    included in all copies or substantial portions of the Software.\n    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n    OTHER DEALINGS IN THE SOFTWARE.\n    */\n\n\nvar mul_table = [\n    512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,\n    454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,\n    482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,\n    437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,\n    497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,\n    320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,\n    446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,\n    329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,\n    505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,\n    399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,\n    324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,\n    268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,\n    451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,\n    385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,\n    332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,\n    289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];\n\n\nvar shg_table = [\n    9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17,\n    17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19,\n    19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20,\n    20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21,\n    21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,\n    21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22,\n    22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,\n    22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23,\n    23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n    23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n    23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n    23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n    24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n    24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n    24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n    24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24 ];\n\n\nfunction processImage(img, canvas, radius, blurAlphaChannel)\n{\n    if (typeof(img) == 'string') {\n        var img = document.getElementById(img);\n    }\n    else if (typeof HTMLImageElement !== 'undefined' && !img instanceof HTMLImageElement) {\n        return;\n    }\n    var w = img.naturalWidth;\n    var h = img.naturalHeight;\n\n    if (typeof(canvas) == 'string') {\n        var canvas = document.getElementById(canvas);\n    }\n    else if (typeof HTMLCanvasElement !== 'undefined' && !canvas instanceof HTMLCanvasElement) {\n        return;\n    }\n\n    canvas.style.width  = w + 'px';\n    canvas.style.height = h + 'px';\n    canvas.width = w;\n    canvas.height = h;\n\n    var context = canvas.getContext('2d');\n    context.clearRect(0, 0, w, h);\n    context.drawImage(img, 0, 0);\n\n    if (Number.isNaN(radius) || radius < 1) return;\n\n    if (blurAlphaChannel)\n        processCanvasRGBA(canvas, 0, 0, w, h, radius);\n    else\n        processCanvasRGB(canvas, 0, 0, w, h, radius);\n}\n\nfunction getImageDataFromCanvas(canvas, top_x, top_y, width, height)\n{\n    if (typeof(canvas) == 'string')\n        var canvas  = document.getElementById(canvas);\n    else if (typeof HTMLCanvasElement !== 'undefined' && !canvas instanceof HTMLCanvasElement)\n        return;\n\n    var context = canvas.getContext('2d');\n    var imageData;\n\n    try {\n        try {\n            imageData = context.getImageData(top_x, top_y, width, height);\n        } catch(e) {\n            throw new Error(\"unable to access local image data: \" + e);\n            return;\n        }\n    } catch(e) {\n        throw new Error(\"unable to access image data: \" + e);\n    }\n\n    return imageData;\n}\n\nfunction processCanvasRGBA(canvas, top_x, top_y, width, height, radius)\n{\n    if (Number.isNaN(radius) || radius < 1) return;\n    radius |= 0;\n\n    var imageData = getImageDataFromCanvas(canvas, top_x, top_y, width, height);\n\n    imageData = processImageDataRGBA(imageData, top_x, top_y, width, height, radius);\n\n    canvas.getContext('2d').putImageData(imageData, top_x, top_y);\n}\n\nfunction processImageDataRGBA(imageData, top_x, top_y, width, height, radius)\n{\n    var pixels = imageData.data;\n\n    var x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum, a_sum,\n        r_out_sum, g_out_sum, b_out_sum, a_out_sum,\n        r_in_sum, g_in_sum, b_in_sum, a_in_sum,\n        pr, pg, pb, pa, rbs;\n\n    var div = radius + radius + 1;\n    var w4 = width << 2;\n    var widthMinus1  = width - 1;\n    var heightMinus1 = height - 1;\n    var radiusPlus1  = radius + 1;\n    var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n\n    var stackStart = new BlurStack();\n    var stack = stackStart;\n    for (i = 1; i < div; i++)\n    {\n        stack = stack.next = new BlurStack();\n        if (i == radiusPlus1) var stackEnd = stack;\n    }\n    stack.next = stackStart;\n    var stackIn = null;\n    var stackOut = null;\n\n    yw = yi = 0;\n\n    var mul_sum = mul_table[radius];\n    var shg_sum = shg_table[radius];\n\n    for (y = 0; y < height; y++)\n    {\n        r_in_sum = g_in_sum = b_in_sum = a_in_sum = r_sum = g_sum = b_sum = a_sum = 0;\n\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi+1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi+2]);\n        a_out_sum = radiusPlus1 * (pa = pixels[yi+3]);\n\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n        a_sum += sumFactor * pa;\n\n        stack = stackStart;\n\n        for (i = 0; i < radiusPlus1; i++)\n        {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack.a = pa;\n            stack = stack.next;\n        }\n\n        for (i = 1; i < radiusPlus1; i++)\n        {\n            p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n            r_sum += (stack.r = (pr = pixels[p])) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = (pg = pixels[p+1])) * rbs;\n            b_sum += (stack.b = (pb = pixels[p+2])) * rbs;\n            a_sum += (stack.a = (pa = pixels[p+3])) * rbs;\n\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n            a_in_sum += pa;\n\n            stack = stack.next;\n        }\n\n\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (x = 0; x < width; x++)\n        {\n            pixels[yi+3] = pa = (a_sum * mul_sum) >> shg_sum;\n            if (pa != 0)\n            {\n                pa = 255 / pa;\n                pixels[yi]   = ((r_sum * mul_sum) >> shg_sum) * pa;\n                pixels[yi+1] = ((g_sum * mul_sum) >> shg_sum) * pa;\n                pixels[yi+2] = ((b_sum * mul_sum) >> shg_sum) * pa;\n            } else {\n                pixels[yi] = pixels[yi+1] = pixels[yi+2] = 0;\n            }\n\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n            a_sum -= a_out_sum;\n\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n            a_out_sum -= stackIn.a;\n\n            p =  (yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1)) << 2;\n\n            r_in_sum += (stackIn.r = pixels[p]);\n            g_in_sum += (stackIn.g = pixels[p+1]);\n            b_in_sum += (stackIn.b = pixels[p+2]);\n            a_in_sum += (stackIn.a = pixels[p+3]);\n\n            r_sum += r_in_sum;\n            g_sum += g_in_sum;\n            b_sum += b_in_sum;\n            a_sum += a_in_sum;\n\n            stackIn = stackIn.next;\n\n            r_out_sum += (pr = stackOut.r);\n            g_out_sum += (pg = stackOut.g);\n            b_out_sum += (pb = stackOut.b);\n            a_out_sum += (pa = stackOut.a);\n\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n            a_in_sum -= pa;\n\n            stackOut = stackOut.next;\n\n            yi += 4;\n        }\n        yw += width;\n    }\n\n\n    for (x = 0; x < width; x++)\n    {\n        g_in_sum = b_in_sum = a_in_sum = r_in_sum = g_sum = b_sum = a_sum = r_sum = 0;\n\n        yi = x << 2;\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi+1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi+2]);\n        a_out_sum = radiusPlus1 * (pa = pixels[yi+3]);\n\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n        a_sum += sumFactor * pa;\n\n        stack = stackStart;\n\n        for (i = 0; i < radiusPlus1; i++)\n        {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack.a = pa;\n            stack = stack.next;\n        }\n\n        yp = width;\n\n        for (i = 1; i <= radius; i++)\n        {\n            yi = (yp + x) << 2;\n\n            r_sum += (stack.r = (pr = pixels[yi])) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = (pg = pixels[yi+1])) * rbs;\n            b_sum += (stack.b = (pb = pixels[yi+2])) * rbs;\n            a_sum += (stack.a = (pa = pixels[yi+3])) * rbs;\n\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n            a_in_sum += pa;\n\n            stack = stack.next;\n\n            if(i < heightMinus1)\n            {\n                yp += width;\n            }\n        }\n\n        yi = x;\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (y = 0; y < height; y++)\n        {\n            p = yi << 2;\n            pixels[p+3] = pa = (a_sum * mul_sum) >> shg_sum;\n            if (pa > 0)\n            {\n                pa = 255 / pa;\n                pixels[p]   = ((r_sum * mul_sum) >> shg_sum) * pa;\n                pixels[p+1] = ((g_sum * mul_sum) >> shg_sum) * pa;\n                pixels[p+2] = ((b_sum * mul_sum) >> shg_sum) * pa;\n            } else {\n                pixels[p] = pixels[p+1] = pixels[p+2] = 0;\n            }\n\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n            a_sum -= a_out_sum;\n\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n            a_out_sum -= stackIn.a;\n\n            p = (x + (((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width)) << 2;\n\n            r_sum += (r_in_sum += (stackIn.r = pixels[p]));\n            g_sum += (g_in_sum += (stackIn.g = pixels[p+1]));\n            b_sum += (b_in_sum += (stackIn.b = pixels[p+2]));\n            a_sum += (a_in_sum += (stackIn.a = pixels[p+3]));\n\n            stackIn = stackIn.next;\n\n            r_out_sum += (pr = stackOut.r);\n            g_out_sum += (pg = stackOut.g);\n            b_out_sum += (pb = stackOut.b);\n            a_out_sum += (pa = stackOut.a);\n\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n            a_in_sum -= pa;\n\n            stackOut = stackOut.next;\n\n            yi += width;\n        }\n    }\n    return imageData;\n}\n\nfunction processCanvasRGB(canvas, top_x, top_y, width, height, radius)\n{\n    if (Number.isNaN(radius) || radius < 1) return;\n    radius |= 0;\n\n    var imageData = getImageDataFromCanvas(canvas, top_x, top_y, width, height);\n    imageData = processImageDataRGB(imageData, top_x, top_y, width, height, radius);\n\n    canvas.getContext('2d').putImageData(imageData, top_x, top_y);\n}\n\nfunction processImageDataRGB(imageData, top_x, top_y, width, height, radius)\n{\n    var pixels = imageData.data;\n\n    var x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum,\n        r_out_sum, g_out_sum, b_out_sum,\n        r_in_sum, g_in_sum, b_in_sum,\n        pr, pg, pb, rbs;\n\n    var div = radius + radius + 1;\n    var w4 = width << 2;\n    var widthMinus1  = width - 1;\n    var heightMinus1 = height - 1;\n    var radiusPlus1  = radius + 1;\n    var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n\n    var stackStart = new BlurStack();\n    var stack = stackStart;\n    for (i = 1; i < div; i++)\n    {\n        stack = stack.next = new BlurStack();\n        if (i == radiusPlus1) var stackEnd = stack;\n    }\n    stack.next = stackStart;\n    var stackIn = null;\n    var stackOut = null;\n\n    yw = yi = 0;\n\n    var mul_sum = mul_table[radius];\n    var shg_sum = shg_table[radius];\n\n    for (y = 0; y < height; y++)\n    {\n        r_in_sum = g_in_sum = b_in_sum = r_sum = g_sum = b_sum = 0;\n\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi+1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi+2]);\n\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n\n        stack = stackStart;\n\n        for (i = 0; i < radiusPlus1; i++)\n        {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack = stack.next;\n        }\n\n        for (i = 1; i < radiusPlus1; i++)\n        {\n            p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n            r_sum += (stack.r = (pr = pixels[p])) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = (pg = pixels[p+1])) * rbs;\n            b_sum += (stack.b = (pb = pixels[p+2])) * rbs;\n\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n\n            stack = stack.next;\n        }\n\n\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (x = 0; x < width; x++)\n        {\n            pixels[yi]   = (r_sum * mul_sum) >> shg_sum;\n            pixels[yi+1] = (g_sum * mul_sum) >> shg_sum;\n            pixels[yi+2] = (b_sum * mul_sum) >> shg_sum;\n\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n\n            p =  (yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1)) << 2;\n\n            r_in_sum += (stackIn.r = pixels[p]);\n            g_in_sum += (stackIn.g = pixels[p+1]);\n            b_in_sum += (stackIn.b = pixels[p+2]);\n\n            r_sum += r_in_sum;\n            g_sum += g_in_sum;\n            b_sum += b_in_sum;\n\n            stackIn = stackIn.next;\n\n            r_out_sum += (pr = stackOut.r);\n            g_out_sum += (pg = stackOut.g);\n            b_out_sum += (pb = stackOut.b);\n\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n\n            stackOut = stackOut.next;\n\n            yi += 4;\n        }\n        yw += width;\n    }\n\n\n    for (x = 0; x < width; x++)\n    {\n        g_in_sum = b_in_sum = r_in_sum = g_sum = b_sum = r_sum = 0;\n\n        yi = x << 2;\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi+1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi+2]);\n\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n\n        stack = stackStart;\n\n        for (i = 0; i < radiusPlus1; i++)\n        {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack = stack.next;\n        }\n\n        yp = width;\n\n        for (i = 1; i <= radius; i++)\n        {\n            yi = (yp + x) << 2;\n\n            r_sum += (stack.r = (pr = pixels[yi])) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = (pg = pixels[yi+1])) * rbs;\n            b_sum += (stack.b = (pb = pixels[yi+2])) * rbs;\n\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n\n            stack = stack.next;\n\n            if(i < heightMinus1)\n            {\n                yp += width;\n            }\n        }\n\n        yi = x;\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (y = 0; y < height; y++)\n        {\n            p = yi << 2;\n            pixels[p]   = (r_sum * mul_sum) >> shg_sum;\n            pixels[p+1] = (g_sum * mul_sum) >> shg_sum;\n            pixels[p+2] = (b_sum * mul_sum) >> shg_sum;\n\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n\n            p = (x + (((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width)) << 2;\n\n            r_sum += (r_in_sum += (stackIn.r = pixels[p]));\n            g_sum += (g_in_sum += (stackIn.g = pixels[p+1]));\n            b_sum += (b_in_sum += (stackIn.b = pixels[p+2]));\n\n            stackIn = stackIn.next;\n\n            r_out_sum += (pr = stackOut.r);\n            g_out_sum += (pg = stackOut.g);\n            b_out_sum += (pb = stackOut.b);\n\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n\n            stackOut = stackOut.next;\n\n            yi += width;\n        }\n    }\n\n    return imageData;\n}\n\nfunction BlurStack()\n{\n    this.r = 0;\n    this.g = 0;\n    this.b = 0;\n    this.a = 0;\n    this.next = null;\n}\n\nexport default {\n    image: processImage,\n    canvasRGBA: processCanvasRGBA,\n    canvasRGB: processCanvasRGB,\n    imageDataRGBA: processImageDataRGBA,\n    imageDataRGB: processImageDataRGB\n};\n","/* eslint-disable max-len */\n// Equations based on NOAA’s Solar Calculator; all angles in radians.\n// http://www.esrl.noaa.gov/gmd/grad/solcalc/\n\nconst π = Math.PI;\nconst radians = π / 180;\nconst degrees = 180 / π;\n\nfunction solarGeometricMeanAnomaly(centuries) {\n  return (357.52911 + centuries * (35999.05029 - 0.0001537 * centuries)) * radians;\n}\n\nfunction solarGeometricMeanLongitude(centuries) {\n  const l = (280.46646 + centuries * (36000.76983 + centuries * 0.0003032)) % 360;\n  return ((l < 0 ? l + 360 : l) / 180) * π;\n}\n\nfunction solarEquationOfCenter(centuries) {\n  const m = solarGeometricMeanAnomaly(centuries);\n  return (Math.sin(m) * (1.914602 - centuries * (0.004817 + 0.000014 * centuries))\n      + Math.sin(m + m) * (0.019993 - 0.000101 * centuries)\n      + Math.sin(m + m + m) * 0.000289) * radians;\n}\n\nfunction solarTrueLongitude(centuries) {\n  return solarGeometricMeanLongitude(centuries) + solarEquationOfCenter(centuries);\n}\n\nfunction solarApparentLongitude(centuries) {\n  return solarTrueLongitude(centuries) - (0.00569 + 0.00478 * Math.sin((125.04 - 1934.136 * centuries) * radians)) * radians;\n}\n\nfunction meanObliquityOfEcliptic(centuries) {\n  return (23 + (26 + (21.448 - centuries * (46.8150 + centuries * (0.00059 - centuries * 0.001813))) / 60) / 60) * radians;\n}\n\nfunction obliquityCorrection(centuries) {\n  return meanObliquityOfEcliptic(centuries) + 0.00256 * Math.cos((125.04 - 1934.136 * centuries) * radians) * radians;\n}\n\nfunction solarDeclination(centuries) {\n  return Math.asin(\n    Math.sin(obliquityCorrection(centuries)) * Math.sin(solarApparentLongitude(centuries)),\n  );\n}\n\nfunction eccentricityEarthOrbit(centuries) {\n  return 0.016708634 - centuries * (0.000042037 + 0.0000001267 * centuries);\n}\n\nfunction equationOfTime(centuries) {\n  const e = eccentricityEarthOrbit(centuries);\n  const m = solarGeometricMeanAnomaly(centuries);\n  const l = solarGeometricMeanLongitude(centuries);\n  let y = Math.tan(obliquityCorrection(centuries) / 2);\n  y *= y;\n  return y * Math.sin(2 * l)\n      - 2 * e * Math.sin(m)\n      + 4 * e * y * Math.sin(m) * Math.cos(2 * l)\n      - 0.5 * y * y * Math.sin(4 * l)\n      - 1.25 * e * e * Math.sin(2 * m);\n}\n\nexport function antipode(position) {\n  return [position[0] + 180, -position[1]];\n}\n\nexport function solarPosition(time) {\n  const centuries = (time - Date.UTC(2000, 0, 1, 12)) / 864e5 / 36525; // since J2000\n  const longitude = ((d3.time.day.utc.floor(time) - time) / 864e5) * 360 - 180;\n  return [\n    longitude - equationOfTime(centuries) * degrees,\n    solarDeclination(centuries) * degrees,\n  ];\n}\n","import Legend from './Legend';\nimport Watermark from './Watermark';\nimport StackBlur from './StackBlur';\nimport utils from '../utils';\nimport { solarPosition, antipode } from './solarPosition';\n\n/**\n * Used the name GeoMap instead of Map to avoid collision with the native Map class of JS\n */\nexport default class GeoMap {\n  /**\n   * Geo Mapping class constructor that will initiate the map drawing\n   * @param maptable: Maptable main Object\n   * @param options: options communicated to map\n   * @param jsonWorld: Object that contain TopoJSON dataset\n   */\n  constructor(maptable, options, jsonWorld) {\n    this.maptable = maptable;\n    this.scale = 1;\n    this.transX = 0;\n    this.transY = 0;\n\n    this.options = options;\n\n    this.jsonWorld = jsonWorld;\n\n    this.containerSelector = maptable.options.target;\n    this.container = document.querySelector(maptable.options.target);\n\n    // Map wrapper\n    const mapWrapper = this.container.querySelector('.mt-map-container');\n\n    const existingMap = this.container.querySelector('#mt-map');\n    if (existingMap) {\n      // transform #mt-map to .mt-map-container'\n      mapWrapper.parentNode.insertBefore(mapWrapper, existingMap);\n      existingMap.parentNode.removeChild(existingMap);\n    }\n\n    // Map\n    this.node = document.createElement('div');\n    this.node.setAttribute('id', 'mt-map');\n    mapWrapper.appendChild(this.node);\n\n    this.svg = d3.select(this.node).append('svg').attr('id', 'mt-map-svg').attr('xmlns', 'http://www.w3.org/2000/svg').attr('xmlns:xlink', 'http://www.w3.org/1999/xlink').attr('viewBox', `0 0 ${this.getWidth()} ${this.getHeight()}`).attr('width', this.getWidth()).attr('height', this.getHeight());\n\n    this.projection = d3.geo\n      .equirectangular()\n      .translate([this.getWidth() / 2, this.getHeight() / (2 * this.options.scaleHeight)])\n      .scale((this.getWidth() / 640) * 100)\n      .rotate([-12, 0])\n      .precision(0.1);\n\n    this.path = d3.geo.path().projection(this.projection);\n\n    this.enrichData();\n\n    this.zoomListener = d3.behavior.zoom().scaleExtent(this.options.scaleZoom).on('zoom', this.rescale.bind(this));\n\n    // Attach Zoom event to map\n    if (this.options.zoom) {\n      this.svg = this.svg.call(this.zoomListener.bind(this));\n    }\n\n    // Add tooltip\n    if (this.options.markers) {\n      this.tooltipMarkersNode = d3.select(this.node).append('div').attr('id', 'mt-map-markers-tooltip').attr('class', `mt-map-tooltip ${this.options.markers.tooltipClassName}`).style('display', 'none');\n    }\n\n    if (this.options.countries) {\n      this.tooltipCountriesNode = d3.select(this.node).append('div').attr('id', 'mt-map-countries-tooltip').attr('class', `mt-map-tooltip ${this.options.countries.tooltipClassName}`).style('display', 'none');\n    }\n\n    this.layerGlobal = this.svg.append('g').attr('class', 'mt-map-global');\n    this.layerDefs = this.svg.append('defs');\n    this.layerDefs.html(`\n    <filter id=\"blur\"><feGaussianBlur stdDeviation=\"18\" /></filter>\n    <radialGradient id=\"sunGradient\">\n        <stop offset=\"0\" stop-color=\"#FFC000\" stop-opacity=\"0.5\" />\n        <stop offset=\"0.45\" stop-color=\"#FFC000\" stop-opacity=\"0.15\" />\n        <stop offset=\"1\" stop-color=\"#FFC000\" stop-opacity=\"0\" />\n      </radialGradient>\n    `);\n    if (this.options.timezones) this.layerTimezones = this.layerGlobal.append('g').attr('class', 'mt-map-timezones');\n    this.layerCountries = this.layerGlobal.append('g').attr('class', 'mt-map-countries');\n    if (this.options.night) this.layerNight = this.layerGlobal.append('g').attr('class', 'mt-map-night');\n\n    if (this.options.heatmap) this.layerHeatmap = this.layerGlobal.append('g').attr('class', 'mt-map-heatmap');\n    this.layerMarkers = this.layerGlobal.append('g').attr('class', 'mt-map-markers');\n\n    // Add Watermark\n    if (this.options.watermark) {\n      this.watermark = new Watermark(this, this.options.watermark);\n    }\n\n    // Add Title\n    if (this.options.title) {\n      this.buildTitle();\n    }\n\n    // Add Export SVG Capability\n    if (this.options.exportSvgClient || this.options.exportSvg) {\n      this.addExportSvgCapability();\n    }\n\n    // AutoResize\n    if (!this.options.width) {\n      window.addEventListener('resize', () => {\n        this.svg.attr('width', this.getWidth());\n        this.svg.attr('height', this.getHeight());\n        this.rescale();\n      });\n    }\n\n    // Let's build things\n    this.loadGeometries();\n\n    // render is triggered by MapTable\n    // this.render();\n  }\n\n  enrichData() {\n    // Add coordinates to rawData\n    this.maptable.rawData.forEach((d) => {\n      d.longitude = parseFloat(d[this.options.longitudeKey]);\n      d.latitude = parseFloat(d[this.options.latitudeKey]);\n      let coord = [0, 0];\n      if (!Number.isNaN(d.longitude) && !Number.isNaN(d.latitude)) {\n        coord = this.projection([d.longitude, d.latitude]);\n      }\n      d.x = coord[0];\n      d.y = coord[1];\n    });\n  }\n\n  scaleAttributes() {\n    return Math.pow(this.scale, 2 / 3); // eslint-disable-line\n  }\n\n  getWidth() {\n    if (this.options.width) {\n      return this.options.width;\n    }\n    this.options.width = this.node.offsetWidth;\n    return this.node.offsetWidth;\n  }\n\n  getHeight() {\n    const deltaHeight = this.options.title ? 30 : 0;\n    if (!this.options.height && this.options.ratioFromWidth) {\n      return this.getWidth() * this.options.ratioFromWidth * this.options.scaleHeight + deltaHeight;\n    }\n    return this.options.height * this.options.scaleHeight + deltaHeight;\n  }\n\n  /**\n   * Load geometries and built the map components\n   */\n  loadGeometries() {\n    // We filter world data\n    if (this.options.filterCountries) {\n      this.jsonWorld.objects.countries.geometries = this.jsonWorld.objects.countries.geometries.filter(this.options.filterCountries);\n    }\n\n    // Build countries\n    if (this.options.countries) this.buildCountries();\n\n    // Build heatmap\n    if (this.options.heatmap) this.buildHeatmap();\n\n    if (this.options.night) this.buildNight();\n    if (this.options.timezones && (this.options.timezones.path || this.options.timezones.pathData)) this.buildTimezone();\n  }\n\n  /**\n   * Logic to build the heatmap elements (without the filling the heatmap image)\n   */\n  buildHeatmap() {\n    // Build vectors\n    const lands = topojson.merge(this.jsonWorld, this.jsonWorld.objects.countries.geometries);\n    if (!this.options.heatmap.disableMask) {\n      this.maskHeatmap = this.layerHeatmap.append('defs').append('clipPath').attr('id', 'mt-map-heatmap-mask');\n\n      this.maskHeatmap.datum(lands).append('path').attr('class', 'mt-map-heatmap-mask-paths').attr('d', this.path);\n    }\n\n    this.imgHeatmap = this.layerHeatmap.append('image').attr('width', this.getWidth()).attr('height', this.getHeight()).attr('x', 0).attr('y', 0).attr('class', 'mt-map-heatmap-img');\n\n    if (this.options.heatmap.mask) {\n      this.imgHeatmap = this.imgHeatmap.attr('clip-path', 'url(#mt-map-heatmap-mask)');\n    }\n\n    if (this.options.heatmap.borders) {\n      const borders = topojson.mesh(this.jsonWorld, this.jsonWorld.objects.countries, (a, b) => a !== b);\n\n      this.bordersHeatmap = this.layerHeatmap.append('g').attr('class', 'mt-map-heatmap-borders');\n\n      this.bordersHeatmap\n        .selectAll('path.mt-map-heatmap-borders-paths')\n        .data([lands, borders])\n        .enter()\n        .append('path')\n        .attr('class', 'mt-map-heatmap-borders-paths')\n        .attr('fill', 'none')\n        .attr('stroke-width', this.options.heatmap.borders.stroke)\n        .attr('stroke', this.options.heatmap.borders.color)\n        .attr('style', `opacity: ${this.options.heatmap.borders.opacity}`)\n        .attr('d', this.path);\n    }\n  }\n\n  /**\n   * Logic to build the night position\n   */\n  buildNight() {\n    this.layerNight = this.layerGlobal.append('g').attr('class', 'mt-map-night');\n\n    const circle = d3.geo.circle().angle(90);\n\n    // Mask night\n    this.maskNight = this.layerNight.append('defs').append('clipPath').attr('id', 'mt-map-night-mask');\n\n    this.maskNight\n      .append('rect')\n      .attr('x', 0)\n      .attr('y', 30)\n      .attr('width', this.getWidth())\n      .attr('height', this.getHeight() * 0.82 - 30);\n\n    // Build vectors\n    this.nightPath = this.layerNight\n      .append('path')\n      .attr('class', `mt-map-night-layer${this.options.night.cssBlur ? ' mt-blur' : ''}`)\n      .attr('filter', this.options.night.cssBlur ? undefined : 'url(#blur)')\n      .attr('clip-path', 'url(#mt-map-night-mask)')\n      .attr('d', this.path)\n      .style('opacity', 0.1);\n\n    const userDate = this.options.night.date || Date.UTC();\n    const startOfDay = Date.UTC(userDate.getUTCFullYear(), userDate.getUTCMonth(), userDate.getUTCDate(), 0, 0, 0);\n    const solarPositionDated = solarPosition(new Date(startOfDay));\n    this.nightPath.datum(circle.origin(antipode(solarPositionDated))).attr('d', this.path);\n\n    this.nightPathRight = this.layerNight\n      .append('path')\n      .attr('class', `mt-map-night-layer${this.options.night.cssBlur ? ' mt-blur' : ''}`)\n      .attr('filter', this.options.night.cssBlur ? undefined : 'url(#blur)')\n      .attr('clip-path', 'url(#mt-map-night-mask)')\n      .attr('d', this.nightPath.attr('d'))\n      .style('opacity', 0.1)\n      .style('transform', `translate3d(${this.getWidth()}px,0,0)`);\n\n    this.nightPathLeft = this.layerNight\n      .append('path')\n      .attr('class', `mt-map-night-layer${this.options.night.cssBlur ? ' mt-blur' : ''}`)\n      .attr('filter', this.options.night.cssBlur ? undefined : 'url(#blur)')\n      .attr('clip-path', 'url(#mt-map-night-mask)')\n      .attr('d', this.nightPath.attr('d'))\n      .style('opacity', 0.1)\n      .style('transform', `translate3d(${-this.getWidth()}px,0,0)`);\n\n    if (!this.options.night.disableSun) {\n      const sunCoords = this.projection(solarPositionDated);\n\n      this.sunCircleRight = this.layerNight\n        .append('svg:circle')\n        .attr('class', 'mt-map-sun-right')\n        .attr('cx', sunCoords[0])\n        .attr('cy', sunCoords[1])\n        .attr('fill', 'url(#sunGradient)')\n        .attr('r', this.getHeight() * 0.35);\n\n      this.sunCircleXRight = this.layerNight\n        .append('svg:circle')\n        .attr('class', 'mt-map-sun-xright')\n        .attr('cx', sunCoords[0] + this.getWidth())\n        .attr('cy', sunCoords[1])\n        .attr('fill', 'url(#sunGradient)')\n        .attr('r', this.getHeight() * 0.35);\n\n      this.sunCircleLeft = this.layerNight\n        .append('svg:circle')\n        .attr('class', 'mt-map-sun-right')\n        .attr('cx', sunCoords[0] - this.getWidth())\n        .attr('cy', sunCoords[1])\n        .attr('fill', 'url(#sunGradient)')\n        .attr('r', this.getHeight() * 0.35);\n\n      this.sunCircleXLeft = this.layerNight\n        .append('svg:circle')\n        .attr('class', 'mt-map-sun-xright')\n        .attr('cx', sunCoords[0] - 2 * this.getWidth())\n        .attr('cy', sunCoords[1])\n        .attr('fill', 'url(#sunGradient)')\n        .attr('r', this.getHeight() * 0.35);\n    }\n  }\n\n  /**\n   * Logic to build the timezone strips\n   */\n  buildTimezone() {\n    if (this.options.timezones.pathData) {\n      this.loadTimezone(null, JSON.parse(this.options.timezones.pathData));\n    } else if (this.options.timezones.path) {\n      d3.json(this.options.timezones.path, (errGeoMap, jsonTimezones) => {\n        this.loadTimezone(errGeoMap, jsonTimezones);\n      });\n    }\n  }\n\n  scaleFontSize(fontSize) {\n    return this.getWidth() < 700 ? fontSize * (this.getWidth() / 700) : fontSize;\n  }\n\n  loadTimezone(err, jsonTimezones) {\n    this.dataTimezones = topojson.feature(jsonTimezones, jsonTimezones.objects.timezones).features;\n\n    // Mask timezone\n    this.maskTimezone = this.layerTimezones.append('defs').append('clipPath').attr('id', 'mt-map-timezone-mask');\n\n    this.maskTimezone\n      .append('rect')\n      .attr('x', 0)\n      .attr('y', 30)\n      .attr('width', this.getWidth())\n      .attr('height', this.getHeight() * 0.82 - 30);\n\n    // Build timezone paths\n    this.layerTimezones\n      .selectAll('.mt-map-timezone')\n      .data(this.dataTimezones.filter((d) => d.properties.places !== 'Antarctica'))\n      .enter()\n      .insert('path')\n      .attr('class', 'mt-map-timezone')\n      .attr('d', this.path)\n      .attr('fill', (d) => (d.properties.zone % 2 === 0 ? '#F4F5F5' : 'transparent'))\n      .attr('title', (d) => JSON.stringify(d.properties))\n      .attr('clip-path', 'url(#mt-map-timezone-mask)')\n      .style('opacity', 0.6);\n\n    // Add times\n    const timezoneTexts = this.dataTimezones.filter((d) => d.properties.places !== 'Antarctica' && d.properties.zone % 1 === 0 && d.properties.zone !== 14);\n    const timezoneTextsUnique = [...new Map(timezoneTexts.map((item) => [item.properties.zone, item])).values()];\n\n    this.layerTimezonesText = this.layerTimezones.append('g').attr('class', 'mt-map-timezones-texts');\n    this.layerTimezonesText\n      .selectAll('.mt-map-timezone-text')\n      .data(timezoneTextsUnique)\n      .enter()\n      .insert('text')\n      .attr('class', 'mt-map-timezone-text')\n      .attr('y', this.getHeight() * 0.82 - 5)\n      .attr('x', (d) => (d.properties.zone + 10) * (this.getWidth() / 24.5) - 1)\n      .attr('dx', this.getWidth() / 24.5 / 2)\n      .attr('font-size', this.scaleFontSize(9))\n      .attr('font-family', 'Helevetica, Arial, Sans-Serif')\n      .attr('fill', '#999')\n      .attr('text-anchor', 'middle')\n      .html((d) => utils.formatDate(this.options.timezones.date || new Date(), d.properties.zone));\n  }\n\n  /**\n   * Get Scale for every circle magnitude\n   * @param heatmapDataset: heatmap dataset that we use\n   * @returns scale: function - Scale function that output a value [0 - 1]\n   */\n  getMagnitudeScale(heatmapDataset) {\n    const opts = this.options.heatmap;\n    const lengthDataset = heatmapDataset.length;\n    if (!lengthDataset) return () => 0;\n    // const layersPerLocation = (opts.circles.max - opts.circles.min) / opts.circles.step;\n    const maxOpacityScale = d3.scale.linear().domain([1, lengthDataset]).range([1, 0.25]);\n    const centralCircleOpacity = maxOpacityScale(lengthDataset);\n\n    const scale = d3.scale.linear().domain([opts.circles.min, 20]).range([centralCircleOpacity, 0]);\n    return (m) => scale(m);\n  }\n\n  /**\n   * Get Scale for every data point (used for weighting)\n   * @returns scale: function - Scale function that output a value [0 - 1]\n   */\n  getDatumScale() {\n    if (!this.options.heatmap.weightByAttribute) return () => 1;\n    const dataExtents = d3.extent(this.maptable.data, this.options.heatmap.weightByAttribute);\n    const userScale = this.options.heatmap.weightByAttributeScale === 'log' ? d3.scale.log : d3.scale.linear;\n    const scale = userScale().domain(dataExtents).range([0.5, 1]);\n    return (d) => {\n      const val = this.options.heatmap.weightByAttribute(d);\n      if (!val) return 0;\n      return scale(val);\n    };\n  }\n\n  /**\n   * Get the Data URL of the heatmap image\n   * @returns {string} base64 image\n   */\n  getHeatmapData() {\n    const canvasHeatmap = d3.select(this.node).append('canvas').attr('id', 'mt-map-heatmap-canvas').attr('width', this.getWidth()).attr('height', this.getHeight()).attr('style', 'display: none;');\n\n    const ctx = canvasHeatmap.node().getContext('2d');\n    ctx.globalCompositeOperation = 'multiply';\n    const circles = d3.range(this.options.heatmap.circles.min, this.options.heatmap.circles.max, this.options.heatmap.circles.step);\n    const datumScale = this.getDatumScale();\n    const heatmapDataset = this.maptable.data.filter((d) => datumScale(d) > 0.1);\n    const path = this.path.context(ctx);\n    const magnitudeScale = this.getMagnitudeScale(heatmapDataset);\n    const colorScale = d3.scale.linear().domain([1, 0]).range(['#000000', '#FFFFFF']);\n\n    // Make a flat white background first\n    ctx.beginPath();\n    ctx.rect(0, 0, this.getWidth(), this.getHeight());\n    ctx.fillStyle = '#ffffff';\n    ctx.fill();\n    ctx.closePath();\n\n    // color strenght factor\n    const colorMultiplier = (x) => {\n      const a = this.options.heatmap.circles.colorStrength;\n      const aa = 1 + (a - 1) / 100;\n      if (a > 1) return (2 - aa) * x + aa - 1;\n      return a * x;\n    };\n\n    // add condensed clouds\n    heatmapDataset.forEach((point) => {\n      const scaleOpacityDatum = datumScale(point);\n      circles.forEach((m) => {\n        const opacity = colorMultiplier(magnitudeScale(m) * scaleOpacityDatum);\n        if (opacity > 0) {\n          ctx.beginPath();\n          path(\n            d3.geo\n              .circle()\n              .origin([point.longitude, point.latitude])\n              .angle(m - 0.0001)()\n          );\n          ctx.fillStyle = colorScale(opacity);\n          ctx.fill();\n          ctx.closePath();\n        }\n      });\n    });\n\n    StackBlur.canvasRGBA(canvasHeatmap.node(), 0, 0, this.getWidth(), this.getHeight(), this.options.heatmap.circles.blur);\n\n    // Add color layer\n    ctx.beginPath();\n    ctx.globalCompositeOperation = 'screen';\n    ctx.rect(0, 0, this.getWidth(), this.getHeight());\n    ctx.fillStyle = this.options.heatmap.circles.color;\n    ctx.fill();\n    ctx.closePath();\n\n    const dataUrl = canvasHeatmap.node().toDataURL();\n    canvasHeatmap.remove();\n    return dataUrl;\n  }\n\n  /**\n   * Set the data URL to the heatmap image\n   */\n  updateHeatmap() {\n    const dataUrl = this.getHeatmapData();\n    this.imgHeatmap.attr('xlink:href', dataUrl);\n  }\n\n  /**\n   * build the paths for the countries\n   */\n  buildCountries() {\n    this.dataCountries = topojson.feature(this.jsonWorld, this.jsonWorld.objects.countries).features;\n    // Build country paths\n    this.layerCountries\n      .selectAll('.mt-map-country')\n      .data(this.dataCountries)\n      .enter()\n      .insert('path')\n      .attr('class', 'mt-map-country')\n      .attr('d', this.path)\n      .attr('id', (d) => `${d.properties.iso_a3}`);\n\n    // Build Country Legend\n    this.legendCountry = {};\n\n    if (this.shouldRenderLegend()) {\n      this.legendCountry.fill = new Legend(this);\n    }\n  }\n\n  shouldRenderLegend() {\n    const f = this.options.countries.attr.fill;\n    if (!f) return false;\n    if (!f.legend || !f.min || !f.max) return false;\n    if (f.aggregate && f.aggregate.scale) {\n      const scale = typeof f.aggregate.scale === 'function' ? f.aggregate.scale.bind(this.maptable)() : f.aggregate.scale;\n      if (scale !== 'linear') return false;\n    }\n    return true;\n  }\n\n  /**\n   * Get all mt-map-country elements\n   */\n  getAllMtMapCountry() {\n    if (this.allMtMapCountry) return this.allMtMapCountry;\n    this.allMtMapCountry = d3.selectAll(`${this.containerSelector} .mt-map-country`);\n    return this.allMtMapCountry;\n  }\n\n  /**\n   * Get all mt-map-marjker elements\n   */\n  getAllMtMapMarker() {\n    if (this.allMtMapMarker) return this.allMtMapMarker;\n    this.allMtMapMarker = d3.selectAll(`${this.containerSelector} .mt-map-marker`);\n    return this.allMtMapMarker;\n  }\n\n  /**\n   * Set the right color for every country\n   */\n  updateCountries() {\n    // Data from user input\n    const dataByCountry = new Map();\n    this.maptable.data.forEach((d) => {\n      const key = d[this.options.countryIdentifierKey];\n      if (!dataByCountry.has(key)) {\n        dataByCountry.set(key, []);\n      }\n      dataByCountry.get(key).push(d);\n    });\n\n    // We merge both data\n    this.dataCountries.forEach((geoDatum) => {\n      geoDatum.key = geoDatum.properties[this.options.countryIdentifierType];\n      const matchedCountry = dataByCountry.get(geoDatum.key);\n      geoDatum.values = matchedCountry || [];\n      geoDatum.attr = {};\n      geoDatum.rollupValue = {};\n    });\n\n    // We calculate attributes values\n    Object.keys(this.options.countries.attr).forEach((k) => {\n      this.setAttrValues(k, this.options.countries.attr[k], this.dataCountries);\n    });\n\n    // Update SVG\n    const countryItem = this.getAllMtMapCountry().each(function (d) {\n      const selection = d3.select(this);\n      Object.keys(d.attr).forEach((key) => {\n        selection.attr(key, d.attr[key]);\n      });\n    });\n\n    // Update Legend\n    Object.keys(this.options.countries.attr).forEach((attrKey) => {\n      const attrValue = this.options.countries.attr[attrKey];\n      if (typeof attrValue === 'object' && attrValue.legend && this.legendCountry[attrKey] !== undefined) {\n        const scaleDomain = d3.extent(this.dataCountries, (d) => Number(d.attrProperties[attrKey].value));\n        this.legendCountry[attrKey].updateExtents(scaleDomain);\n\n        // When we mouseover the legend, it should highlight the indice selected\n        countryItem\n          .on('mouseover', (d) => {\n            this.legendCountry[attrKey].indiceChange(d.attrProperties[attrKey].value);\n          })\n          .on('mouseout', () => {\n            this.legendCountry[attrKey].indiceChange(NaN);\n          });\n      }\n    });\n\n    // Update Tooltip\n    if (this.options.countries && this.options.countries.tooltip) {\n      this.activateTooltip(countryItem, this.tooltipCountriesNode, this.options.countries.tooltip, true);\n    }\n  }\n\n  /**\n   * Update night drawings\n   */\n  updateNight() {\n    const userDate = this.options.night.date || Date.UTC();\n    const startOfDay = Date.UTC(userDate.getUTCFullYear(), userDate.getUTCMonth(), userDate.getUTCDate(), 0, 0, 0);\n    const endOfDay = Date.UTC(userDate.getUTCFullYear(), userDate.getUTCMonth(), userDate.getUTCDate(), 23, 59, 59);\n\n    const totalMilliseconds = endOfDay - startOfDay;\n    const currentTime = userDate - startOfDay;\n    const relativeTranslateX = currentTime / totalMilliseconds;\n\n    this.layerNight.node().style.transform = `translateX(${-this.getWidth() * relativeTranslateX}px)`;\n  }\n\n  /**\n   * Update night drawings\n   */\n  updateTimezones() {\n    const timezoneTexts = document.querySelectorAll('.mt-map-timezone-text');\n    const currentDate = this.options.timezones.date || new Date();\n\n    Array.from(timezoneTexts).forEach((timezoneText) => {\n      timezoneText.textContent = utils.formatDate(currentDate, timezoneText.__data__.properties.zone);\n    });\n  }\n\n  updateMarkers() {\n    const defaultGroupBy = (a) => `${a.longitude},${a.latitude}`;\n\n    this.dataMarkers = d3\n      .nest()\n      .key(defaultGroupBy)\n      .entries(this.maptable.data)\n      .filter((d) => d.values[0].x !== 0);\n\n    // We merge both data\n    this.dataMarkers.forEach((d) => {\n      d.attr = {};\n      d.attrProperties = {};\n    });\n\n    // We calculate attributes values\n    Object.keys(this.options.markers.attr).forEach((k) => {\n      this.setAttrValues(k, this.options.markers.attr[k], this.dataMarkers);\n    });\n\n    // Enter\n    const markerItem = this.layerMarkers.selectAll('.mt-map-marker').data(this.dataMarkers);\n    let markerObject = markerItem.enter();\n    if (this.options.markers.customTag) {\n      markerObject = this.options.markers.customTag(markerObject);\n    } else {\n      markerObject = markerObject.append('svg:circle');\n    }\n    const markerClassName = this.options.markers.className ? this.options.markers.className : '';\n\n    markerObject.attr('class', `mt-map-marker ${markerClassName}`);\n\n    // Exit\n    markerItem.exit().transition().attr('r', 0).attr('fill', '#eee').style('opacity', 0).remove();\n\n    // Update\n    const attrX = this.options.markers.attrX ? this.options.markers.attrX : 'cx';\n    const attrY = this.options.markers.attrY ? this.options.markers.attrY : 'cy';\n\n    const attrXDelta = this.options.markers.attrXDelta ? this.options.markers.attrXDelta : 0;\n    const attrYDelta = this.options.markers.attrYDelta ? this.options.markers.attrYDelta : 0;\n\n    const markerUpdate = markerItem.attr(attrX, (d) => d.values[0].x + attrXDelta).attr(attrY, (d) => d.values[0].y + attrYDelta);\n\n    this.getAllMtMapMarker().each(function (d) {\n      Object.keys(d.attr).forEach((key) => {\n        d3.select(this).attr(key, d.attr[key]);\n      });\n    });\n\n    if (this.options.markers.tooltip) {\n      this.activateTooltip(markerUpdate, this.tooltipMarkersNode, this.options.markers.tooltip, false);\n    }\n\n    this.rescale();\n  }\n\n  fitContent() {\n    if (this.maptable.data.length === 0) {\n      this.transX = 0;\n      this.transY = 0;\n      this.scale = 1;\n      this.zoomListener.translate([this.transX, this.transY]).scale(this.scale);\n      return;\n    }\n    const hor = d3.extent(this.maptable.data, (d) => d.x);\n    const ver = d3.extent(this.maptable.data, (d) => d.y);\n\n    // center dots with the good ratio\n    const ratio = this.getWidth() / this.getHeight();\n    const deltaMarker = 20 + (this.options.title ? 30 : 0);\n\n    const currentWidth = hor[1] - hor[0] + deltaMarker;\n    const currentHeight = ver[1] - ver[0] + deltaMarker;\n\n    const realHeight = currentWidth / ratio;\n    const realWidth = currentHeight * ratio;\n\n    let diffMarginWidth = 0;\n    let diffMarginHeight = 0;\n    if (realWidth >= currentWidth) {\n      diffMarginWidth = (realWidth - currentWidth) / 2;\n    } else {\n      diffMarginHeight = (realHeight - currentHeight) / 2;\n    }\n\n    // add layout margin\n    hor[0] -= this.options.fitContentMargin + diffMarginWidth;\n    hor[1] += this.options.fitContentMargin + diffMarginWidth;\n    ver[0] -= this.options.fitContentMargin + diffMarginHeight;\n    ver[1] += this.options.fitContentMargin + diffMarginHeight;\n\n    this.scale = this.getWidth() / (hor[1] - hor[0]);\n    this.transX = -1 * hor[0] * this.scale;\n    this.transY = -1 * ver[0] * this.scale;\n\n    this.zoomListener.translate([this.transX, this.transY]).scale(this.scale);\n  }\n\n  buildTitle() {\n    const titleContainer = this.svg\n      .append('svg')\n      .attr('width', this.getWidth())\n      .attr('x', 0)\n      .attr('y', this.getHeight() - 30)\n      .attr('height', 30);\n\n    if (this.options.title.bgColor) {\n      titleContainer.append('rect').attr('x', 0).attr('y', 0).attr('width', this.getWidth()).attr('height', 30).attr('fill', this.options.title.bgColor);\n    }\n\n    titleContainer.append('text').attr('id', 'mt-map-title').attr('x', 20).attr('font-size', this.scaleFontSize(this.options.title.fontSize)).attr('font-family', this.options.title.fontFamily).attr('y', 20);\n\n    if (this.options.title.source) {\n      titleContainer\n        .append('text')\n        .attr('y', 20)\n        .attr('x', this.getWidth() - 20)\n        .attr('text-anchor', 'end')\n        .attr('font-size', this.scaleFontSize(this.options.title.fontSize))\n        .attr('font-family', this.options.title.fontFamily)\n        .html(this.options.title.source());\n    }\n  }\n\n  /**\n   * We encode a transaltion to be independent from the dimensions of the visualization\n   * @param originalTranslation: Array - original translation value (from screen)\n   * @returns encodedTranslation: Array - encoded translation\n   */\n  encodeTranslation(originalTranslation) {\n    const newTx = originalTranslation[0] / (this.scale * this.getWidth());\n\n    const newTy = originalTranslation[1] / (this.scale * this.getHeight());\n\n    return [newTx, newTy];\n  }\n\n  /**\n   * We decode a translation to adapt it to the dimensions of the visualization\n   * @param encodedTranslation: Array - encoded translation\n   * @returns originalTranslation: Array - original translation value (from screen)\n   */\n  decodeTranslation(encodedTranslation) {\n    const newTx = encodedTranslation[0] * this.getWidth() * this.scale;\n\n    const newTy = encodedTranslation[1] * this.getHeight() * this.scale;\n\n    return [newTx, newTy];\n  }\n\n  /**\n   * Restore state from the url hash\n   */\n  restoreState(defaultZoom) {\n    if (!defaultZoom || defaultZoom.length !== 3) return;\n    this.scale = defaultZoom[0];\n    const originalTranslation = this.decodeTranslation([defaultZoom[1], defaultZoom[2]]);\n    this.transX = originalTranslation[0];\n    this.transY = originalTranslation[1];\n    this.zoomListener.scale(defaultZoom[0]).translate(originalTranslation).event(this.svg);\n  }\n\n  /**\n   * Save state into the url hash\n   */\n  saveState() {\n    const encodedTranslation = this.encodeTranslation([this.transX, this.transY]);\n    const exportedData = [this.scale, encodedTranslation[0], encodedTranslation[1]];\n    if (exportedData[0] !== 1 && exportedData[1] !== 0 && exportedData[2] !== 0) {\n      this.maptable.saveState('zoom', exportedData);\n    } else {\n      this.maptable.removeState('zoom');\n    }\n  }\n\n  rescale() {\n    const self = this;\n    let defaultScaleTo = typeof this.options.defaultScaleTo === 'function' ? this.options.defaultScaleTo.bind(this.maptable)() : this.options.defaultScaleTo;\n\n    if (defaultScaleTo) {\n      // if default zoom state is set by latitude/longitude\n      if (defaultScaleTo.scaleType === 'lat/lng') {\n        this.scale = defaultScaleTo.values.scale || 1;\n        const transXY = this.getTransXYForLatLng(defaultScaleTo.values.latitude || 0, defaultScaleTo.values.longitude || 0, defaultScaleTo.values.scale || 1);\n        this.transX = transXY.tx || 0;\n        this.transY = transXY.ty || 0;\n\n        if (d3.event && d3.event.translate) {\n          this.transX = this.scale === 1 ? 0 : d3.event.translate[0] + transXY.tx;\n          this.transY = this.scale === 1 ? 0 : d3.event.translate[1] + transXY.ty;\n        }\n      } else if (defaultScaleTo.scaleType === 'country') {\n        // if default zoom state is set by ISO alpha-3 country code\n        const countryTransXY = this.getTransXYForCountry(defaultScaleTo.values.iso_a3);\n        this.scale = countryTransXY.tscale || 1;\n        this.transX = countryTransXY.tx || 0;\n        this.transY = countryTransXY.ty || 0;\n\n        if (d3.event && d3.event.translate) {\n          this.transX = this.scale === 1 ? 0 : d3.event.translate[0] + countryTransXY.tx;\n          this.transY = this.scale === 1 ? 0 : d3.event.translate[1] + countryTransXY.ty;\n        }\n      }\n    } else {\n      if (d3.event && d3.event.translate) {\n        this.scale = d3.event.scale;\n        this.transX = this.scale === 1 ? 0 : d3.event.translate[0];\n        this.transY = this.scale === 1 ? 0 : d3.event.translate[1];\n      }\n    }\n\n    const maxTransX = 0;\n    const maxTransY = 0;\n    const minTransX = this.getWidth() * (1 - this.scale);\n    const minTransY = this.getHeight() * (1 - this.scale);\n\n    if (this.transY > maxTransY) {\n      this.transY = maxTransY;\n    } else if (this.transY < minTransY) {\n      this.transY = minTransY;\n    }\n\n    if (this.transX > maxTransX) {\n      this.transX = maxTransX;\n    } else if (this.transX < minTransX) {\n      this.transX = minTransX;\n    }\n\n    if (d3.event && d3.event.translate) {\n      d3.event.translate[0] = this.transX;\n      d3.event.translate[1] = this.transY;\n    }\n\n    this.layerGlobal.style('transform', `translate(${this.transX}px,${this.transY}px)scale(${this.scale})`);\n\n    // Hide tooltip\n    if (self.tooltipCountriesNode) self.tooltipCountriesNode.attr('style', 'display:none;');\n    if (self.tooltipMarkersNode) self.tooltipMarkersNode.attr('style', 'display:none;');\n\n    // Rescale markers size\n    if (this.options.markers) {\n      // markers\n      this.getAllMtMapMarker().each(function (d) {\n        // stroke\n        if (d.attr['stroke-width']) {\n          d3.select(this).attr('stroke-width', d.attr['stroke-width'] / self.scaleAttributes());\n        }\n        // radius\n        if (d.attr.r) {\n          d3.select(this).attr('r', d.attr.r / self.scaleAttributes());\n        }\n      });\n    }\n\n    // Rescale Sun\n    if (this.options.night && !this.options.disableSun) {\n      d3.selectAll(`${this.containerSelector} .mt-map-sun`).style('r', (this.getHeight() * 0.35) / this.scale);\n    }\n\n    // Rescale Country stroke-width\n    if (this.options.countries) {\n      this.getAllMtMapCountry().style('stroke-width', this.options.countries.attr['stroke-width'] / this.scale);\n    }\n\n    // Rescale heatmap borders\n    if (this.options.heatmap && this.options.heatmap.borders) {\n      d3.selectAll(`${this.containerSelector} .mt-map-heatmap-borders-paths`).style('stroke-width', this.options.heatmap.borders.stroke / this.scale);\n    }\n\n    // save state\n    if (this.maptable.firstExecution && this.options.saveState) this.saveState();\n  }\n\n  // calculate translateX, translateY and scale values based on input latitude, longitude and scale value\n  getTransXYForLatLng(latitude, longitude, scale) {\n    const lng = parseFloat(longitude);\n    const lat = parseFloat(latitude);\n\n    const coo = this.projection([lng, lat]);\n    const sc = scale || 1;\n\n    const tx = this.getWidth() / 2 - sc * coo[0];\n    const ty = this.getHeight() / 2 - sc * coo[1];\n\n    return { tx, ty };\n  }\n\n  // calculate translateX, translateY and scale values based on input ISO alpha-3 country code\n  getTransXYForCountry(country_code) {\n    const currentCountryCode = country_code;\n    const currentCountryData = this.dataCountries.filter((d) => {\n      return d.properties.iso_a3 === currentCountryCode;\n    });\n    let tx = 0;\n    let ty = 0;\n    let tscale = 1;\n    if (currentCountryData[0]) {\n      const bounds = this.path.bounds(currentCountryData[0]);\n      const dx = bounds[1][0] - bounds[0][0];\n      const dy = bounds[1][1] - bounds[0][1];\n      const x = (bounds[0][0] + bounds[1][0]) / 2;\n      const y = (bounds[0][1] + bounds[1][1]) / 2;\n      const sc = 0.95 / Math.max(dx / this.getWidth(), dy / this.getHeight());\n      const tr = [this.getWidth() / 2 - sc * x, this.getHeight() / 2 - sc * y];\n      tscale = sc;\n      tx = tr[0];\n      ty = tr[1];\n    }\n\n    return { tx, ty, tscale };\n  }\n\n  setAttrValues(attrKey, attrValue, dataset) {\n    if (typeof attrValue === 'number' || typeof attrValue === 'string') {\n      // Static value\n      dataset.forEach((d) => {\n        d.attr[attrKey] = attrValue;\n      });\n    } else if (typeof attrValue === 'function') {\n      // Dynamic value based on the dataset\n      dataset.forEach((d) => {\n        d.attr[attrKey] = attrValue(d);\n      });\n    } else if (typeof attrValue === 'object') {\n      let scale = 'linear';\n      let key = null;\n      let mode = 'count';\n      let scaleToUse = d3.scale.linear();\n      if (attrValue.aggregate) {\n        key = typeof attrValue.aggregate.key === 'function' ? attrValue.aggregate.key.bind(this.maptable)() : attrValue.aggregate.key;\n\n        mode = typeof attrValue.aggregate.mode === 'function' ? attrValue.aggregate.mode.bind(this.maptable)() : attrValue.aggregate.mode;\n\n        if (typeof attrValue.aggregate.scale === 'function') {\n          scale = attrValue.aggregate.scale.bind(this.maptable)();\n        } else if (attrValue.aggregate.scale) {\n          scale = attrValue.aggregate.scale;\n        }\n\n        if (!key || !mode) {\n          throw new Error(`MapTable: You should provide values 'key' & 'mode' for attr.${attrKey}.aggregate`);\n        }\n\n        // Custom aggregate mode\n        if (mode === 'sum') {\n          attrValue.rollup = (groupedData) => groupedData.map((d) => Number(d[key])).reduce((a, c) => a + c, 0);\n        } else if (mode === 'avg') {\n          attrValue.rollup = (groupedData) => {\n            if (!groupedData.length) return 0;\n            const validData = groupedData.filter((d) => !Number.isNaN(Number(d[key])));\n            return validData.map((d) => Number(d[key])).reduce((a, c) => a + c, 0) / validData.length;\n          };\n        } else if (mode === 'count') {\n          attrValue.rollup = (groupedData) => groupedData.length;\n        } else if (mode === 'min') {\n          attrValue.rollup = (groupedData) => {\n            if (!groupedData.length) return 0;\n            const groupedValues = groupedData.map((d) => Number(d[key]));\n            return groupedValues.reduce((min, p) => (p < min ? p : min), groupedValues[0]);\n          };\n        } else if (mode === 'max') {\n          attrValue.rollup = (groupedData) => {\n            if (!groupedData.length) return 0;\n            const groupedValues = groupedData.map((d) => Number(d[key]));\n            return groupedValues.reduce((max, p) => (p > max ? p : max), groupedValues[0]);\n          };\n        } else if (mode.indexOf('percentile') !== -1) {\n          const percentile = utils.toNumber(mode);\n          attrValue.rollup = (groupedData) => {\n            if (!groupedData.length) return 0;\n            const groupedValues = groupedData.map((d) => Number(d[key]));\n            return utils.quantile(groupedValues, percentile);\n          };\n        } else if (typeof attrValue.rollup === 'function') {\n          attrValue.rollup = attrValue.rollup.bind(this.maptable);\n        }\n\n        // Custom scale\n        if (scale) {\n          if (scale.indexOf('log') !== -1) {\n            scaleToUse = d3.scale.log();\n          } else if (scale.indexOf('pow') !== -1) {\n            scaleToUse = d3.scale.pow().exponent(utils.toNumber(scale) || 1);\n          } else if (scale === 'sqrt') {\n            scaleToUse = d3.scale.sqrt();\n          }\n          // Rank scale neeed additional transformations\n        }\n      }\n\n      // Dynamic value based on a scale\n      if (!attrValue.rollup) {\n        attrValue.rollup = (d) => d.length;\n      }\n      if (!attrValue.min || !attrValue.max) {\n        throw new Error(`MapTable: You should provide values 'min' & 'max' for attr.${attrKey}`);\n      }\n\n      dataset.forEach((d) => {\n        const aggregatedValue = attrValue.rollup(d.values);\n        if (!d.attrProperties) d.attrProperties = {};\n        if (!d.attrProperties[attrKey]) d.attrProperties[attrKey] = {};\n        d.attrProperties[attrKey].value = aggregatedValue;\n        if (key) {\n          d.attrProperties[attrKey].key = key;\n          d.attrProperties[attrKey].mode = mode;\n          d.attrProperties[attrKey].scale = scale;\n          const c = this.maptable.columnDetails[key];\n          d.attrProperties[attrKey].columnDetails = c;\n          const datum = {};\n          datum[key] = aggregatedValue;\n          d.attrProperties[attrKey].formatted = c && c.cellContent ? c.cellContent.bind(this.maptable)(datum) : aggregatedValue;\n        }\n      });\n      if (scale === 'rank') {\n        const positiveRanks = utils.uniqueValues([0].concat(dataset.map((d) => Math.floor(d.attrProperties[attrKey].value * 100) / 100).filter((v) => v > 0)));\n        const negativeRanks = utils.uniqueValues(dataset.map((d) => Math.floor(d.attrProperties[attrKey].value * 100) / 100).filter((v) => v < 0));\n\n        positiveRanks.sort((a, b) => a - b);\n        negativeRanks.sort((a, b) => b - a);\n\n        dataset.forEach((d) => {\n          if (d.attrProperties[attrKey].value !== 0) {\n            const ranks = d.attrProperties[attrKey].value >= 0 ? positiveRanks : negativeRanks;\n            const pos = ranks.indexOf(Math.floor(d.attrProperties[attrKey].value * 100) / 100);\n            const percentile = Math.round((pos / ranks.length) * 100);\n            const newValue = d.attrProperties[attrKey].value < 0 ? percentile - percentile * 2 : percentile;\n            d.attrProperties[attrKey].value = newValue;\n          }\n        });\n      }\n\n      let scaleDomain = d3.extent(dataset, (d) => Number(d.attrProperties[attrKey].value));\n      if (scaleDomain[0] === 0 && scale && scale.indexOf('log') !== '-1') {\n        scaleDomain = d3.extent(\n          dataset.filter((v) => Number(v.attrProperties[attrKey].value) !== 0),\n          (d) => Number(d.attrProperties[attrKey].value)\n        );\n      }\n      if (attrValue.transform) {\n        scaleDomain[0] = attrValue.transform.bind(this.maptable)(scaleDomain[0], this.maptable.data);\n        scaleDomain[1] = attrValue.transform.bind(this.maptable)(scaleDomain[1], this.maptable.data);\n      }\n\n      let minValue = attrValue.min;\n      let maxValue = attrValue.max;\n\n      if (attrValue.min === 'minValue') {\n        minValue = scaleDomain[0];\n      }\n      if (attrValue.max === 'maxValue') {\n        maxValue = scaleDomain[1];\n      }\n\n      // check for negative color declarations\n      if ((attrValue.maxNegative && !attrValue.minNegative) || (!attrValue.maxNegative && attrValue.minNegative)) {\n        throw new Error('MapTable: maxNegative or minNegative undefined. Please declare both.');\n      }\n      const useNegative = attrValue.maxNegative && attrValue.minNegative;\n      let scaleFunction;\n      let scaleNegativeFunction;\n\n      if (useNegative) {\n        scaleFunction = scaleToUse.copy().domain([0, scaleDomain[1]]).range([minValue, maxValue]);\n        scaleNegativeFunction = scaleToUse.copy().domain([scaleDomain[0], 0]).range([attrValue.maxNegative, attrValue.minNegative]);\n      } else {\n        scaleFunction = scaleToUse.domain(scaleDomain).range([minValue, maxValue]);\n      }\n\n      dataset.forEach((d) => {\n        let scaledValue;\n        if (!d.values.length || Number.isNaN(d.attrProperties[attrKey].value)) {\n          if (typeof attrValue.empty === 'undefined') {\n            throw new Error(`MapTable: no empty property found for attr.${attrKey}`);\n          }\n          scaledValue = attrValue.empty;\n        } else {\n          const originalValueRaw = d.attrProperties[attrKey].value;\n          const originalValue = attrValue.transform ? attrValue.transform.bind(this.maptable)(originalValueRaw, this.maptable.data) : originalValueRaw;\n\n          if (useNegative && originalValue < 0) {\n            scaledValue = scaleNegativeFunction(originalValue);\n          } else {\n            scaledValue = scaleFunction(originalValue);\n          }\n        }\n        d.attr[attrKey] = scaledValue;\n      });\n    } else {\n      throw new Error(`Maptable: Invalid value for ${attrKey}`);\n    }\n  }\n\n  render() {\n    if (this.options.markers) this.updateMarkers();\n    if (this.options.countries) this.updateCountries();\n    if (this.options.night) this.updateNight();\n    if (this.options.timezones) this.updateTimezones();\n    if (this.options.title) this.updateTitle();\n    if (this.options.heatmap) this.updateHeatmap();\n    if (this.options.autoFitContent) {\n      this.fitContent();\n      this.rescale();\n    }\n    // On render\n    if (this.options.onRender && this.options.onRender.constructor === Function) {\n      this.options.onRender.bind(this.maptable)();\n    }\n  }\n\n  updateTitle() {\n    if (this.options.title.content) {\n      const showing = this.maptable.data.filter((d) => d[this.options.latitudeKey] !== 0).length;\n      const total = this.maptable.rawData.filter((d) => d[this.options.latitudeKey] !== 0).length;\n\n      let inlineFilters = '';\n      if (this.maptable.filters) {\n        inlineFilters = this.maptable.filters.getDescription();\n      }\n\n      this.container.querySelector('#mt-map-title').innerHTML = this.options.title.content.bind(this.maptable)(showing, total, inlineFilters, this.maptable.data, this.maptable.rawData, this.dataCountries);\n    }\n  }\n\n  activateTooltip(target, tooltipNode, tooltipContent, isCountry) {\n    const self = this;\n    target\n      .on(isCountry ? 'mousemove' : 'mouseover', function (d) {\n        const content = tooltipContent.bind(this.maptable)(d);\n        if (!content) return;\n        tooltipNode.html(content).attr('style', 'display:block;position:fixed;');\n\n        let mouseLeft;\n        let mouseTop;\n        const tooltipDelta = tooltipNode.node().offsetWidth / 2;\n        if (isCountry) {\n          const mapRect = self.node.getBoundingClientRect();\n          const mousePosition = d3.mouse(self.svg.node()).map((v) => parseInt(v, 10));\n\n          mouseLeft = mapRect.left + mousePosition[0] - tooltipDelta;\n          mouseTop = mapRect.top + mousePosition[1] + 10;\n        } else {\n          const targetRect = this.getBoundingClientRect();\n          mouseLeft = targetRect.left + targetRect.width / 2 - tooltipDelta;\n          mouseTop = targetRect.top + targetRect.height + 2; // +2 is for the border\n        }\n\n        tooltipNode.attr('style', `top:${mouseTop}px;left:${mouseLeft}px;display:block;position:fixed;`).on('mouseout', () => {\n          tooltipNode.style('display', 'none');\n        });\n      })\n      .on('mouseout', () => {\n        tooltipNode.style('display', 'none');\n      });\n  }\n\n  exportSvg() {\n    // Get the d3js SVG element\n    const svg = this.container.querySelector('#mt-map-svg');\n    // Extract the data as SVG text string\n    const svgXml = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n${new XMLSerializer().serializeToString(svg)}`;\n\n    if (this.options.exportSvgClient) {\n      if (!window.saveAs) {\n        throw new Error('MapTable: Missing FileSaver.js library');\n      }\n      const blob = new Blob([svgXml], { type: 'image/svg+xml' });\n      window.saveAs(blob, 'visualization.svg');\n    } else if (this.options.exportSvg) {\n      const form = this.node.querySelector('#mt-map-svg-form');\n      form.querySelector('[name=\"data\"]').value = svgXml;\n      form.submit();\n    }\n  }\n\n  addExportSvgCapability() {\n    const exportNode = document.createElement('div');\n    exportNode.setAttribute('id', 'mt-map-export');\n    this.container.querySelector('#mt-map').appendChild(exportNode);\n\n    const exportButton = document.createElement('button');\n    exportButton.setAttribute('class', 'btn btn-xs btn-default');\n    exportButton.innerHTML = 'Download';\n    exportButton.addEventListener('click', this.exportSvg.bind(this));\n    exportNode.appendChild(exportButton);\n\n    if (this.options.exportSvg) {\n      const exportForm = document.createElement('div');\n      exportForm.innerHTML = `<form id=\"mt-map-svg-form\" method=\"post\"\n  action=\"${this.options.exportSvg}\"><input type=\"hidden\" name=\"data\"></form>`;\n      exportNode.appendChild(exportForm);\n    }\n  }\n}\n","import utils from '../utils';\n\nexport default class Filters {\n  constructor(maptable, options) {\n    this.maptable = maptable;\n    this.options = options;\n    this.criteria = [];\n\n    if (this.options.show) {\n      const arrayDiff = this.options.show.filter((i) => Object.keys(this.maptable.columnDetails).indexOf(i) < 0);\n      if (arrayDiff.length > 0) {\n        throw new Error(`MapTable: invalid columns \"${arrayDiff.join(', ')}\"`);\n      }\n      this.activeColumns = this.options.show;\n    } else {\n      this.activeColumns = Object.keys(this.maptable.columnDetails);\n    }\n\n    this.container = document.createElement('div');\n    this.maptable.node.appendChild(this.container);\n\n    this.containerSelector = maptable.options.target;\n    this.container = document.querySelector(maptable.options.target);\n    this.node = this.container.querySelector('#mt-filters');\n\n    if (!this.node) {\n      this.node = document.createElement('div');\n      this.node.setAttribute('id', 'mt-filters');\n      this.node.setAttribute('class', 'panel panel-default');\n      this.maptable.node.appendChild(this.node);\n    }\n\n    // -- Filters Header\n\n    const filtersHeaderNode = document.createElement('div');\n    filtersHeaderNode.setAttribute('class', 'panel-heading');\n\n    const filtersResetNode = document.createElement('button');\n    filtersResetNode.setAttribute('id', 'mt-filters-reset');\n    filtersResetNode.setAttribute('class', 'btn btn-default btn-xs pull-right');\n    filtersResetNode.style.display = 'none';\n    filtersResetNode.style.marginLeft = 5;\n    filtersResetNode.innerText = '↺ Reset';\n    filtersResetNode.addEventListener('click', this.reset);\n    filtersHeaderNode.appendChild(filtersResetNode);\n\n    const filtersTitleNode = document.createElement('h3');\n    filtersTitleNode.setAttribute('class', 'panel-title');\n    filtersTitleNode.appendChild(document.createTextNode('Filters'));\n    filtersHeaderNode.appendChild(filtersTitleNode);\n\n    this.node.appendChild(filtersHeaderNode);\n\n    // -- Filters Content\n    const filtersBodyNode = document.createElement('div');\n    filtersBodyNode.setAttribute('id', 'mt-filters-content');\n    filtersBodyNode.setAttribute('class', 'panel-body');\n\n    const filtersElementsNode = document.createElement('div');\n    filtersElementsNode.setAttribute('id', 'mt-filters-elements');\n    filtersBodyNode.appendChild(filtersElementsNode);\n\n    const filtersNewNode = document.createElement('a');\n    filtersNewNode.setAttribute('id', 'mt-filters-new');\n    filtersNewNode.setAttribute('href', '#');\n    filtersNewNode.innerText = '+ New filter';\n    filtersNewNode.addEventListener('click', this.add.bind(this));\n    filtersBodyNode.appendChild(filtersNewNode);\n\n    this.node.appendChild(filtersBodyNode);\n  }\n\n  /**\n   * Add a filter\n   * @param evt: Window Event Object\n   */\n  add(evt) {\n    if (evt) evt.preventDefault();\n    const possibleFilters = this.getPossibleFilters();\n\n    if (possibleFilters.length === 0) {\n      return;\n    }\n    const filterName = possibleFilters[0].key;\n    this.create(filterName);\n  }\n\n  create(filterName, replaceNode) {\n    const rowNode = this.buildRow(filterName);\n    if (replaceNode) {\n      replaceNode.parentNode.replaceChild(rowNode, replaceNode);\n    } else {\n      this.node.querySelector('#mt-filters-elements').appendChild(rowNode);\n    }\n    this.criteria.push(filterName);\n    this.maptable.render();\n    if (this.container.style.display === 'none') {\n      this.toggle();\n    }\n  }\n\n  remove(filterName) {\n    const rowNode = this.node.querySelector(`[data-mt-filter-name=\"${filterName}\"]`);\n    if (rowNode) rowNode.parentNode.removeChild(rowNode);\n    const filterIndex = this.criteria.indexOf(filterName);\n    this.criteria.splice(filterIndex, 1);\n    this.maptable.render();\n  }\n\n  /**\n   * Reset filters\n   */\n  reset() {\n    const rowNodes = this.node.querySelectorAll('[data-mt-filter-name]');\n    for (let i = 0; i < rowNodes.length; i += 1) {\n      rowNodes[i].parentNode.removeChild(rowNodes[i]);\n    }\n    this.criteria = [];\n    this.maptable.render();\n  }\n\n  /**\n   * Export the current filters to an object\n   * @returns exportedFilters: Object - key => value that contain data about the current filters\n   */\n  exportFilters() {\n    const output = {};\n    const filtersChildren = this.node.querySelector('#mt-filters-elements').childNodes;\n\n    for (let i = 0; i < filtersChildren.length; i += 1) {\n      const element = filtersChildren[i];\n      const filterName = element.querySelector('.mt-filter-name').value;\n      const columnDetails = this.maptable.columnDetails[filterName];\n      const filterOutput = [columnDetails.filterMethod];\n      if (columnDetails.filterMethod === 'compare') {\n        const filterRangeSelect = element.querySelector('.mt-filter-range');\n        if (filterRangeSelect) {\n          filterOutput[1] = filterRangeSelect.value;\n\n          if (filterRangeSelect.value !== 'any') {\n            if (filterRangeSelect.value === 'BETWEEN') {\n              const filterValueMin = element.querySelector('.mt-filter-value-min').value;\n              const filterValueMax = element.querySelector('.mt-filter-value-max').value;\n              if (filterValueMin !== '' && filterValueMax === '') {\n                filterOutput[2] = filterValueMin;\n                filterOutput[3] = filterValueMax;\n              }\n            } else {\n              const filterValue = element.querySelector('.mt-filter-value-min').value;\n              filterOutput[2] = filterValue;\n            }\n          }\n        }\n      } else if (columnDetails.filterMethod === 'field' || columnDetails.filterMethod === 'dropdown') {\n        filterOutput[1] = '';\n        const filterValue = element.querySelector('.mt-filter-value').value;\n        filterOutput[2] = filterValue;\n      }\n      if (filterOutput[1] !== 'any' && filterOutput[2] && filterOutput[2] !== '') {\n        output[filterName] = filterOutput;\n      }\n    }\n    return output;\n  }\n\n  /**\n   * Set the value for the current filters\n   * @param criteria - Object - same format as the exportedFilters\n   */\n  setFilters(criteria) {\n    this.reset();\n    Object.keys(criteria).forEach((filterName) => {\n      this.create(filterName);\n      const criterion = criteria[filterName];\n      const row = document.querySelector(`#mt-filters-elements [data-mt-filter-name=\"${filterName}\"]`);\n      if (row) {\n        if (criterion[0] === 'compare') {\n          row.querySelector('.mt-filter-range').value = criterion[1];\n          if (criterion[1] !== 'any') {\n            if (criterion[1] === 'BETWEEN') {\n              row.querySelector('.mt-filter-value-min').value = criterion[2];\n              row.querySelector('.mt-filter-value-max').value = criterion[3];\n            } else {\n              row.querySelector('.mt-filter-value-min').value = criterion[2];\n            }\n          }\n        } else if (criterion[0] === 'field' || criterion[0] === 'dropdown') {\n          row.querySelector('.mt-filter-value').value = decodeURIComponent(criterion[2]);\n        }\n      }\n    });\n    this.maptable.render();\n  }\n\n  /**\n   * Restore state from the URL hash\n   */\n  restoreState(defaultCriteria) {\n    if (!defaultCriteria) return;\n    this.setFilters(defaultCriteria);\n  }\n\n  /**\n   *  Get a human readable description of the filters (used for the title)\n   * @returns {string} Human readable description\n   */\n  getDescription() {\n    const outputArray = [];\n\n    const filtersChildren = this.node.querySelector('#mt-filters-elements').childNodes;\n\n    for (let i = 0; i < filtersChildren.length; i += 1) {\n      const element = filtersChildren[i];\n      const filterName = element.querySelector('.mt-filter-name').value;\n\n      const columnDetails = this.maptable.columnDetails[filterName];\n\n      let line = '';\n\n      if (columnDetails.filterMethod === 'compare') {\n        const filterRangeSelect = element.querySelector('.mt-filter-range');\n        if (filterRangeSelect.value !== 'any') {\n          if (filterRangeSelect.value === 'BETWEEN') {\n            const filterValueMin = element.querySelector('.mt-filter-value-min').value;\n            const filterValueMax = element.querySelector('.mt-filter-value-max').value;\n            if (filterValueMin === '' || filterValueMax === '') continue;\n            line += `${columnDetails.title} is between `;\n            line += `<tspan font-weight=\"bold\">${filterValueMin}</tspan> and\n              <tspan font-weight=\"bold\">${filterValueMax}</tspan>`;\n          } else {\n            const filterValue = element.querySelector('.mt-filter-value-min').value;\n            if (filterValue === '') continue;\n            line += `${columnDetails.title} is `;\n            line += filterRangeSelect.options[filterRangeSelect.selectedIndex].text;\n            line += `<tspan font-weight=\"bold\">${filterValue}</tspan>`;\n          }\n        }\n      } else if (columnDetails.filterMethod === 'field' || columnDetails.filterMethod === 'dropdown') {\n        const filterValue = element.querySelector('.mt-filter-value').value;\n        if (filterValue === '') continue;\n        const separatorWord = columnDetails.filterMethod === 'field' ? 'contains' : 'is';\n        line += `${columnDetails.title} ${separatorWord}\n          <tspan font-weight=\"bold\">${filterValue}</tspan>`;\n      }\n      outputArray.push(line);\n    }\n    return outputArray.join(', ');\n  }\n\n  buildRow(filterName) {\n    const that = this;\n\n    const possibleFilters = this.getPossibleFilters();\n\n    const columnDetails = this.maptable.columnDetails[filterName];\n\n    const rowNode = document.createElement('div');\n    rowNode.setAttribute('class', 'mt-filter-row');\n    rowNode.setAttribute('data-mt-filter-name', filterName);\n\n    // Button to remove filter\n    const minusButton = document.createElement('button');\n    minusButton.setAttribute('class', 'btn btn-default pull-right');\n    minusButton.setAttribute('data-mt-filter-btn-minus', 1);\n    minusButton.innerText = '– Remove this filter';\n    minusButton.addEventListener('click', () => {\n      filterName = rowNode.querySelector('.mt-filter-name').value;\n      this.remove(filterName);\n    });\n    rowNode.appendChild(minusButton);\n\n    // Filters separator \"AND\"\n    const filterSeparator = document.createElement('span');\n    filterSeparator.setAttribute('class', 'mt-filters-and');\n    filterSeparator.innerText = 'And ';\n    rowNode.appendChild(filterSeparator);\n\n    // Filter name select\n    const filterNameSelect = document.createElement('select');\n    filterNameSelect.setAttribute('class', 'mt-filter-name form-control form-control-inline');\n    utils.appendOptions(\n      filterNameSelect,\n      possibleFilters.map((f) => ({ text: f.title, value: f.key }))\n    );\n    filterNameSelect.value = filterName;\n\n    filterNameSelect.addEventListener('change', function () {\n      const oldFilterName = this.parentNode.getAttribute('data-mt-filter-name');\n      const newFilterName = this.value;\n      that.create(newFilterName, this.parentNode);\n      that.remove(oldFilterName);\n      that.refresh();\n    });\n    rowNode.appendChild(filterNameSelect);\n\n    // Filter verb\n    const filterVerb = document.createElement('span');\n    filterVerb.innerText = columnDetails.filterMethod === 'field' ? ' contains ' : ' is ';\n    rowNode.appendChild(filterVerb);\n\n    // Filter range\n    let filterRange = null;\n    if (columnDetails.filterMethod !== 'field' && columnDetails.filterMethod !== 'dropdown') {\n      filterRange = document.createElement('select');\n      filterRange.setAttribute('class', 'mt-filter-range form-control form-control-inline');\n      utils.appendOptions(\n        filterRange,\n        ['any', '=', '≠', '<', '>', '≤', '≥', 'BETWEEN'].map((v) => ({ text: v, value: v }))\n      );\n      filterRange.addEventListener('change', function () {\n        that.handleRangeChange(this);\n      });\n      rowNode.appendChild(filterRange);\n\n      // Little space:\n      rowNode.appendChild(document.createTextNode(' '));\n    }\n\n    // Filter value\n    const filterValue = document.createElement('div');\n    filterValue.style.display = 'inline-block';\n    filterValue.setAttribute('class', 'mt-filter-value-container');\n\n    if (columnDetails.filterMethod === 'compare') {\n      ['min', 'max'].forEach((val, i) => {\n        const filterInput = document.createElement('input');\n        filterInput.setAttribute('class', `form-control form-control-inline mt-filter-value-${val}`);\n        filterInput.setAttribute('type', columnDetails.filterInputType);\n        filterInput.addEventListener('keyup', this.maptable.render.bind(this.maptable));\n        filterInput.addEventListener('change', this.maptable.render.bind(this.maptable));\n        filterValue.appendChild(filterInput);\n        if (i === 0) {\n          // AND\n          const filterValueAnd = document.createElement('span');\n          filterValueAnd.setAttribute('class', 'mt-filter-value-and');\n          filterValueAnd.innerText = ' and ';\n          filterValue.appendChild(filterValueAnd);\n        }\n      });\n    } else if (columnDetails.filterMethod === 'field') {\n      const filterInput = document.createElement('input');\n      filterInput.setAttribute('class', 'form-control form-control-inline mt-filter-value');\n      filterInput.setAttribute('type', 'text');\n      filterInput.addEventListener('keyup', this.maptable.render.bind(this.maptable));\n      filterInput.addEventListener('change', this.maptable.render.bind(this.maptable));\n      filterValue.appendChild(filterInput);\n    } else if (columnDetails.filterMethod === 'dropdown') {\n      const filterSelect = document.createElement('select');\n      filterSelect.setAttribute('class', 'form-control form-control-inline mt-filter-value');\n\n      const uniqueValues = d3\n        .nest()\n        .key((d) => d[filterName])\n        .sortKeys(d3.ascending)\n        .entries(this.maptable.rawData);\n\n      utils.appendOptions(filterSelect, [{ text: 'Any', value: '' }].concat(uniqueValues.map((k) => ({ text: k.key, value: k.key }))));\n\n      filterSelect.addEventListener('change', this.maptable.render.bind(this.maptable));\n      filterValue.appendChild(filterSelect);\n    }\n\n    rowNode.appendChild(filterValue);\n\n    // We trigger it here to handle the value of the filter range\n    if (filterRange) {\n      this.handleRangeChange(filterRange);\n    }\n\n    return rowNode;\n  }\n\n  handleRangeChange(filterRange) {\n    const rowNode = filterRange.parentNode;\n    if (filterRange.value === 'any') {\n      rowNode.querySelector('.mt-filter-value-container').style.display = 'none';\n    } else {\n      rowNode.querySelector('.mt-filter-value-container').style.display = 'inline-block';\n      if (filterRange.value === 'BETWEEN') {\n        rowNode.querySelector('.mt-filter-value-min').style.display = 'inline-block';\n        rowNode.querySelector('.mt-filter-value-and').style.display = 'inline-block';\n        rowNode.querySelector('.mt-filter-value-max').style.display = 'inline-block';\n      } else {\n        rowNode.querySelector('.mt-filter-value-min').style.display = 'inline-block';\n        rowNode.querySelector('.mt-filter-value-and').style.display = 'none';\n        rowNode.querySelector('.mt-filter-value-max').style.display = 'none';\n      }\n    }\n    this.maptable.render.bind(this.maptable)();\n  }\n\n  getPossibleFilters(except) {\n    return Object.keys(this.maptable.columnDetails)\n      .map((k) => utils.extendRecursive({ key: k }, this.maptable.columnDetails[k]))\n      .filter((v) => this.activeColumns.indexOf(v.key) !== -1 && ((except && except === v.key) || (this.criteria.indexOf(v.key) === -1 && v.filterMethod && !v.isVirtual)));\n  }\n\n  filterData() {\n    const that = this;\n    this.maptable.data = this.maptable.rawData.filter((d) => {\n      const rowNodes = this.node.querySelectorAll('.mt-filter-row');\n      let matched = true;\n      for (let i = 0; i < rowNodes.length && matched; i += 1) {\n        const rowNode = rowNodes[i];\n        const filterName = rowNode.getAttribute('data-mt-filter-name');\n        const columnDetails = that.maptable.columnDetails[filterName];\n        const fmt = columnDetails.dataParse; // shortcut\n\n        if (columnDetails.filterMethod === 'dropdown') {\n          const filterValue = rowNode.querySelector('.mt-filter-value').value;\n          if (filterValue === '') continue;\n          if (d[filterName] !== filterValue) matched = false;\n        } else if (columnDetails.filterMethod === 'field') {\n          const filterValue = rowNode.querySelector('.mt-filter-value').value;\n          if (filterValue === '') continue;\n          if (d[filterName].toLowerCase().indexOf(filterValue.toLowerCase()) === -1) {\n            matched = false;\n          }\n        } else if (columnDetails.filterMethod === 'compare') {\n          const filterRange = rowNode.querySelector('.mt-filter-range').value;\n          if (filterRange === 'BETWEEN') {\n            const filterValueMin = rowNode.querySelector('.mt-filter-value-min').value;\n            const filterValueMax = rowNode.querySelector('.mt-filter-value-max').value;\n            if (filterValueMin === '' || filterValueMax === '') continue;\n            if (fmt && (fmt(d[filterName]) < fmt(filterValueMin) || fmt(d[filterName]) > fmt(filterValueMax))) {\n              matched = false;\n            } else if (parseInt(d[filterName], 10) < parseInt(filterValueMin, 10) || parseInt(d[filterName], 10) > parseInt(filterValueMax, 10)) {\n              matched = false;\n            }\n          } else {\n            const filterValue = rowNode.querySelector('.mt-filter-value-min').value;\n            if (filterValue === '') continue;\n            if (fmt && !utils.rangeToBool(fmt(d[filterName]), filterRange, fmt(filterValue))) {\n              matched = false;\n            } else if (!fmt && !utils.rangeToBool(d[filterName], filterRange, filterValue)) {\n              matched = false;\n            }\n          }\n        }\n\n        if ((fmt && utils.isBlank(fmt(d[filterName]))) || utils.isBlank(d[filterName])) {\n          matched = false;\n          continue;\n        }\n      }\n      return matched;\n    });\n    // save state\n    if (this.options.saveState) this.maptable.saveState('filters', this.exportFilters());\n  }\n\n  refresh() {\n    // update dropdown\n    const filterNameSelects = this.node.querySelectorAll('.mt-filter-name');\n    for (let i = 0; i < filterNameSelects.length; i += 1) {\n      const filterNameSelect = filterNameSelects[i];\n      const filterName = filterNameSelect.value;\n      const possibleFilters = this.getPossibleFilters(filterName);\n      filterNameSelect.innerHTML = '';\n      utils.appendOptions(\n        filterNameSelect,\n        possibleFilters.map((f) => ({ text: f.title, value: f.key }))\n      );\n      filterNameSelect.value = filterName;\n    }\n\n    // Hide the first \"And\"\n    if (this.node.querySelectorAll('.mt-filters-and').length > 0) {\n      this.node.querySelectorAll('.mt-filters-and')[0].style.visibility = 'hidden';\n    }\n\n    // Check if we reached the maximum of allowed filters\n    const disableNewFilter = !this.getPossibleFilters().length;\n    this.node.querySelector('#mt-filters-new').style.visibility = disableNewFilter ? 'hidden' : 'visible';\n  }\n\n  toggle() {\n    if (this.container.style.display === 'none') {\n      this.container.style.display = 'block';\n      if (this.criteria.length === 0) {\n        this.add();\n      }\n    } else {\n      this.container.style.display = 'none';\n    }\n  }\n}\n","import utils from '../utils';\n\nexport default class Table {\n  /**\n   * Table componenet constructor\n   * @param maptable: Maptable main Object\n   * @param options: options communicated to the table\n   * @returns {string|*}\n   */\n  constructor(maptable, options) {\n    this.maptable = maptable;\n    this.options = options;\n    this.sorting = []; // initialize sort array\n\n    if (this.options.defaultSorting) {\n      if (Array.isArray(this.options.defaultSorting) && (this.options.defaultSorting.length === 2 || this.options.defaultSorting.length === 3)) {\n        // handle case for second-order and third-order sort options\n        this.sorting = this.options.defaultSorting;\n      } else if (Array.isArray(this.options.defaultSorting) && this.options.defaultSorting.length >= 4) {\n        // handle case for more than three default sort options\n        this.sorting = this.options.defaultSorting.slice(0, 3);\n      } else {\n        // handle case for single default sort option\n        this.sorting = [this.options.defaultSorting];\n      }\n      this.sorting.forEach((s) => {\n        if (!s.mode) s.mode = 'asc';\n      });\n    } else {\n      this.sorting = [\n        {\n          key: Object.keys(this.maptable.data[0])[0],\n          mode: 'asc',\n        },\n      ];\n    }\n\n    this.initialSorting = this.sorting.map((s) => `${s.key},${s.mode}`).join(';');\n    this.isSorting = false;\n\n    this.containerSelector = maptable.options.target;\n    this.container = document.querySelector(maptable.options.target);\n\n    this.node = this.container.querySelector('#mt-table');\n\n    if (!this.node) {\n      this.node = document.createElement('div');\n      this.node.setAttribute('id', 'mt-table');\n      this.maptable.node.appendChild(this.node);\n    }\n\n    this.node = d3.select(this.node).append('table').attr('class', this.options.className);\n\n    this.header = this.node.append('thead');\n\n    this.body = this.node.append('tbody');\n\n    if (this.options.show) {\n      const arrayDiff = this.options.show.filter((i) => Object.keys(this.maptable.columnDetails).indexOf(i) < 0);\n      if (arrayDiff.length > 0) {\n        throw new Error(`MapTable: invalid columns \"${arrayDiff.join(', ')}\"`);\n      }\n      this.activeColumns = this.options.show;\n    } else {\n      this.activeColumns = Object.keys(this.maptable.columnDetails);\n    }\n\n    // make table header fixed\n    if (this.options.header) {\n      if (this.options.header.className) {\n        this.header.attr('class', `${this.options.header.className}`);\n      }\n\n      // set custom top header space\n      if (this.options.header.top) {\n        this.header.attr('style', `top:${this.options.header.top || '0'}px;`);\n      } else {\n        this.header.attr('style', 'top:0px;');\n      }\n    }\n\n    this.header\n      .selectAll('tr')\n      .data([1])\n      .enter()\n      .append('tr')\n      .selectAll('th')\n      .data(this.activeColumns.map((k) => utils.extendRecursive({ key: k }, this.maptable.columnDetails[k])))\n      .enter()\n      .append('th')\n      .attr('class', (d) => {\n        let output = d.sorting ? 'mt-table-sortable' : '';\n        output += d.nowrap ? ' nowrap' : '';\n        return output;\n      })\n      .attr('data-key', (d) => utils.sanitizeKey(d.key))\n      .attr('onselectstart', 'return false;')\n      .attr('unselectable', 'on')\n      .attr('style', (d) => (d.nowrap ? 'white-space:nowrap;' : ''))\n      .on('click', (d) => {\n        if (this.isSorting) return;\n        this.isSorting = true;\n        if (d.sorting) {\n          this.sortColumn(d.key);\n        }\n        this.isSorting = false;\n      })\n      .text((d) => d.title)\n      .attr('id', (d) => `column_header_${utils.sanitizeKey(d.key)}`);\n\n    // render is triggered by MapTable\n    // this.render();\n  }\n\n  /**\n   * Restore state from the url hash\n   */\n  restoreState(sortingRaw) {\n    if (!sortingRaw) return;\n    const sortingList = sortingRaw.split(';');\n    const defaultSorting = [];\n    sortingList.forEach((s) => {\n      const sortingData = s.split(',');\n      defaultSorting.push({\n        key: sortingData[0],\n        mode: sortingData[1] || 'asc',\n      });\n    });\n    this.sorting = defaultSorting;\n  }\n\n  /**\n   * Save state into the url hash\n   */\n  saveState() {\n    const encodedSorting = this.sorting.map((s) => `${s.key},${s.mode}`).join(';');\n    if (encodedSorting !== this.initialSorting) {\n      this.maptable.saveState('sort', encodedSorting);\n    }\n  }\n\n  render() {\n    // Apply Sort\n    this.applySort();\n    let tableData = this.maptable.data;\n    if (this.options.distinctBy) {\n      tableData = d3\n        .nest()\n        .key((d) => d[this.options.distinctBy])\n        .entries(this.maptable.data)\n        .map((g) => g.values[0]);\n    }\n\n    // Enter\n    this.body.selectAll('tr').data(tableData).enter().append('tr');\n\n    // Exit\n    this.body.selectAll('tr').data(tableData).exit().remove();\n\n    // Update\n    const uniqueCollapsedRows = [];\n    this.sortIndex = 0;\n    this.body\n      .selectAll('tr')\n      .data(tableData)\n      .attr('class', (row, index) => {\n        const enableSeparator = this.isEndOfPrimarySort(tableData, index);\n        if (this.options.rowClassName) {\n          return `line ${this.options.rowClassName(row)} ${enableSeparator ? 'bold' : ''}`;\n        }\n        return `line ${enableSeparator ? 'bold' : ''}`;\n      })\n      .html((row) => {\n        let tds = '';\n        this.activeColumns.forEach((columnKey) => {\n          const column = this.maptable.columnDetails[columnKey];\n          tds += '<td';\n          if (column.nowrap) {\n            tds += ' style=\"white-space:nowrap;\"';\n          }\n          tds += '>';\n\n          if (!(this.options.collapseRowsBy.indexOf(columnKey) !== -1 && uniqueCollapsedRows[columnKey] && uniqueCollapsedRows[columnKey] === row[columnKey])) {\n            if (column.cellContent) {\n              tds += column.cellContent(row);\n            } else if (column.virtual) {\n              tds += column.virtual(row);\n            } else if (row[columnKey] && row[columnKey] !== 'null') tds += row[columnKey];\n            if (this.options.collapseRowsBy.indexOf(columnKey) !== -1) {\n              uniqueCollapsedRows[columnKey] = row[columnKey];\n            }\n          }\n          tds += '</td>';\n        });\n        return tds;\n      })\n      .append('span')\n      .attr('class', `table-sort-sn ${!this.options.dataCountIndicator || (this.options.dataCountIndicator && !this.options.dataCountIndicator.enabled) || (this.sorting && this.sorting.length <= 1) ? 'display-none' : ''} `)\n      .html((row, index) => {\n        const isSortGroupEnd = this.isEndOfPrimarySort(tableData, index - 1);\n        if (isSortGroupEnd) {\n          this.sortIndex = 1;\n        } else {\n          this.sortIndex += 1;\n        }\n        return `${this.sortIndex}`;\n      });\n\n    // On render\n    if (this.options.onRender && this.options.onRender.constructor === Function) {\n      this.options.onRender.bind(this.maptable)();\n    }\n  }\n\n  applySort() {\n    const sortableColums = this.container.querySelectorAll('.mt-table-sortable');\n    for (let i = 0; i < sortableColums.length; i += 1) {\n      sortableColums[i].setAttribute('class', 'mt-table-sortable');\n    }\n    this.sorting.forEach((column, index) => {\n      this.container.querySelector(`#column_header_${utils.sanitizeKey(column.key)}`).setAttribute('class', `mt-table-sortable sort_${column.mode} sort_order_${index + 1}`);\n    });\n    this.maptable.data = this.maptable.data.sort((a, b) => {\n      let compareBool = false;\n      this.sorting.forEach((column) => {\n        const d3SortMode = column.mode === 'asc' ? d3.ascending : d3.descending;\n        const d3CustomSortMode = column.mode === 'asc' ? utils.customSortAsc : utils.customSortDesc;\n        const columnDetails = this.maptable.columnDetails[column.key];\n        let el1 = a[column.key];\n        let el2 = b[column.key];\n        if (columnDetails.dataParse) {\n          el1 = columnDetails.dataParse.bind(this.maptable)(el1);\n          el2 = columnDetails.dataParse.bind(this.maptable)(el2);\n        } else if (columnDetails.virtual) {\n          el2 = columnDetails.virtual.bind(this.maptable)(a);\n          el2 = columnDetails.virtual.bind(this.maptable)(b);\n        } else if (columnDetails.filterType === 'compare') {\n          el1 = Number(el1);\n          el2 = Number(el2);\n        }\n\n        if (typeof el1 === 'string' && typeof el2 === 'string') {\n          el1 = el1.toLowerCase();\n          el2 = el2.toLowerCase();\n        }\n\n        if (columnDetails.filterInputType === 'months' || columnDetails.filterInputType === 'days') {\n          const currentCustomSortValues = this.options.customSortOrder && this.options.customSortOrder.filter((cs) => cs.key === column.key);\n          const currentCustomSortOrder = currentCustomSortValues && currentCustomSortValues.length !== 0 ? currentCustomSortValues[0].order || [] : [];\n          compareBool = compareBool || d3CustomSortMode(columnDetails.filterInputType, el1, el2, currentCustomSortOrder);\n        } else {\n          compareBool = compareBool || d3SortMode(el1, el2);\n        }\n      });\n      return compareBool;\n    });\n  }\n\n  /**\n   * Sort Table by a column key\n   * @param columnKey: String - column key\n   */\n  sortColumn(key) {\n    const sortIndex = this.sorting.map((d) => d.key).indexOf(key);\n    const sortValue = { key };\n    if (sortIndex === -1) {\n      sortValue.mode = 'desc';\n      if (d3.event && d3.event.shiftKey) {\n        // FIFO - pop last sort element from array after third-order-sorting\n        if (this.sorting.length === 3) {\n          this.sorting.pop();\n        }\n        // FIFO - push new sort element to array\n        this.sorting.unshift(sortValue);\n      } else {\n        this.sorting = [sortValue];\n      }\n    } else {\n      if (this.sorting[sortIndex].mode === 'asc') {\n        this.sorting[sortIndex].mode = 'desc';\n      } else {\n        this.sorting[sortIndex].mode = 'asc';\n        // this.sorting.splice(sortIndex, 1); // to disable sorting\n      }\n      if (!d3.event.shiftKey) {\n        this.sorting = [this.sorting[sortIndex]];\n      } else {\n        // FIFO - set latest clicked column key as first-order-sorting\n        this.reOrderSorting(sortIndex, 0);\n      }\n    }\n    this.saveState();\n    this.render();\n  }\n\n  /**\n   * Util for changing position of sorting array elements\n   * @param from: from position index\n   * @param to: to position index\n   */\n  reOrderSorting(from, to) {\n    if (to === from) return;\n\n    var target = this.sorting[from];\n    var increment = to < from ? -1 : 1;\n\n    for (var k = from; k != to; k += increment) {\n      this.sorting[k] = this.sorting[k + increment];\n    }\n    this.sorting[to] = target;\n  }\n\n  /**\n   * Util for finding end of primary sort data\n   * @param data: table data\n   * @param index: current row index\n   */\n  isEndOfPrimarySort(data, index) {\n    // check if data group separator is enabled from passed options\n    if (!this.options.dataGroupSeparator || (this.options.dataGroupSeparator && !this.options.dataGroupSeparator.enabled)) return false;\n    // check if multi-order-sort\n    if (this.sorting && this.sorting.length <= 1) return false;\n\n    const primarySort = this.sorting[0].key || '';\n    if (data[index] && data[index + 1]) {\n      if (data[index][primarySort] && data[index + 1][primarySort]) {\n        // stringify everything before .toLowerCase()\n        return `${data[index][primarySort]}`.toLowerCase() !== `${data[index + 1][primarySort]}`.toLowerCase();\n      }\n    }\n    return false;\n  }\n}\n","import utils from './utils';\n\nimport GeoMap from './components/GeoMap';\nimport Filters from './components/Filters';\nimport Table from './components/Table';\n\nexport default class MapTable {\n  constructor(target, options) {\n    this.options = options;\n\n    this.state = {};\n    this.saveStateTimeout = {};\n    this.removeStateTimeout = null;\n\n    this.node = document.querySelector(target);\n    this.node.setAttribute('style', 'position:relative;');\n\n    if (this.options.data.type === 'json') {\n      d3.json(this.options.data.path, this.loadData.bind(this));\n    } else if (this.options.data.type === 'csv') {\n      d3.csv(this.options.data.path, this.loadData.bind(this));\n    } else if (this.options.data.type === 'tsv') {\n      d3.tsv(this.options.data.path, this.loadData.bind(this));\n    } else if (this.options.data.type === 'jsonData') {\n      this.loadData(null, JSON.parse(this.options.data.value));\n    } else if (this.options.data.type === 'csvData') {\n      this.loadData(null, d3.csv.parse(this.options.data.value));\n    } else if (this.options.data.type === 'tsvData') {\n      this.loadData(null, d3.tsv.parse(this.options.data.value));\n    } else if (this.options.data.type === 'data') {\n      this.loadData(null, this.options.data.value);\n    }\n\n    if (this.options.map && this.options.map.heatmap) {\n      delete this.options.map.countries;\n    }\n  }\n\n  /**\n   * Callback used when we pull the dataset\n   * @param err: Error - error data if it happened\n   * @param data: Object - dataset object\n   */\n  loadData(err, data) {\n    if (err) {\n      throw err;\n    }\n    this.rawData = data;\n\n    if (this.options.data.preFilter) {\n      this.rawData = this.rawData.filter(this.options.data.preFilter);\n    }\n\n    this.setColumnDetails();\n    this.data = this.rawData.slice(); // we clone data, so that we can filter it\n    // Map\n    if (this.options.map) {\n      // Map wrapper\n      const mapWrapper = document.createElement('div');\n      mapWrapper.setAttribute('class', 'mt-map-container');\n      const isIE = navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0;\n      if (this.options.map.heatmap && isIE) {\n        mapWrapper.innerHTML = '<div class=\"mt-loading\">The heatmap feature is not supported with Internet Explorer.<br>Please use another modern browser to see this map.</div>';\n        this.node.insertBefore(mapWrapper, this.node.firstChild);\n        mapWrapper.querySelector('.mt-loading').style.display = 'block';\n        this.options.map = false;\n        this.buildComponenents();\n        return;\n      }\n      mapWrapper.innerHTML = '<div class=\"mt-loading\">Loading...</div>';\n      this.node.insertBefore(mapWrapper, this.node.firstChild);\n      mapWrapper.querySelector('.mt-loading').style.display = 'block';\n      if (this.options.map.pathData) {\n        this.loadMapData(null, JSON.parse(this.options.map.pathData), mapWrapper);\n      } else if (this.options.map.path) {\n        d3.json(this.options.map.path, (errGeoMap, jsonWorld) => {\n          this.loadMapData(errGeoMap, jsonWorld, mapWrapper);\n        });\n      } else {\n        throw new Error('missing map path|pathData');\n      }\n    } else {\n      this.buildComponenents();\n    }\n  }\n\n  loadMapData(errGeoMap, jsonWorld, mapWrapper) {\n    if (errGeoMap) {\n      throw errGeoMap;\n    }\n    this.map = new GeoMap(this, this.options.map, jsonWorld);\n\n    mapWrapper.querySelector('.mt-loading').style.display = 'none';\n\n    this.buildComponenents();\n  }\n\n  buildComponenents() {\n    // Filters\n    if (this.options.filters) {\n      this.filters = new Filters(this, this.options.filters);\n    }\n\n    // Table\n    if (this.options.table) {\n      this.table = new Table(this, this.options.table);\n    }\n\n    // Restore state\n    this.restoreState();\n    window.addEventListener('hashchange', () => {\n      this.restoreState();\n    });\n\n    // Render\n    this.render();\n  }\n\n  /**\n   * Load state from url\n   * @param stateName: name of the state (either filters or zoom)\n   * @param isJson: do we need to decode a json from the state?\n   * @return loaded state\n   */\n  loadState(stateName, isJson) {\n    // JSON state\n    if (isJson) {\n      const v = this.parseState(stateName);\n      if (!v) return null;\n      try {\n        const parsedState = JSON.parse(v);\n        this.state[stateName] = parsedState;\n      } catch (e) {\n        console.log(`Maptable: Invalid URL State for mt-${stateName} ${e.message}`);\n        return null;\n      }\n    } else {\n      const v = this.parseState(stateName);\n      if (v) this.state[stateName] = v;\n    }\n    return this.state[stateName];\n  }\n\n  /**\n   * Restore state for filters or/and map zooming and/or sorting\n   */\n  restoreState() {\n    if (this.map) {\n      this.loadState('zoom', true);\n      this.map.restoreState(this.state.zoom);\n    }\n\n    if (this.filters) {\n      this.loadState('filters', true);\n      this.filters.restoreState(this.state.filters);\n    }\n\n    if (this.table) {\n      this.loadState('sort', false);\n      this.table.restoreState(this.state.sort);\n    }\n  }\n\n  /**\n   * Extract state from the url\n   * @param stateName: name of the state (either filters or zoom)\n   */\n  parseState(stateName) {\n    const params = document.location.href.replace(/%21mt/g, '!mt').split(`!mt-${stateName}=`);\n    return params[1] ? decodeURIComponent(params[1].split('!mt')[0]) : null;\n  }\n\n  /**\n   * Remove state\n   * @param stateName: name of the state (either filters or zoom)\n   */\n  removeState(stateName) {\n    window.clearTimeout(this.saveStateTimeout[stateName]);\n    delete this.state[stateName];\n    this.updateState();\n  }\n\n  /**\n   * Save the state in this.state\n   * @param stateName: name of the state (either filters or zoom)\n   * @param stateData: object, contain state information\n   */\n  saveState(stateName, stateData) {\n    window.clearTimeout(this.saveStateTimeout[stateName]);\n    this.saveStateTimeout[stateName] = window.setTimeout(() => {\n      this.state[stateName] = stateData;\n      this.updateState();\n    }, 200);\n  }\n\n  /**\n   * Update state into the URL hash\n   */\n  updateState() {\n    const newUrl = document.location.href.split('#')[0];\n    let stateHash = '';\n    Object.keys(this.state).forEach((k) => {\n      if (!this.state[k]) return;\n      let stateValue = this.state[k];\n      if (typeof this.state[k] === 'object') {\n        if (!Object.keys(this.state[k]).length) return;\n        stateValue = JSON.stringify(this.state[k]);\n      }\n      stateHash += `!mt-${k}=${encodeURIComponent(stateValue)}`;\n    });\n    if (stateHash !== '') stateHash = `#${stateHash}`;\n    if (document.location.href !== `${newUrl}${stateHash}`) {\n      window.history.pushState(null, null, `${newUrl}${stateHash}`);\n    }\n  }\n\n  render() {\n    if (this.filters) {\n      this.filters.filterData();\n      this.filters.refresh();\n    }\n\n    if (this.map) {\n      this.map.render();\n      // On complete\n      if (!this.firstExecution && this.options.map.onComplete && this.options.map.onComplete.constructor === Function) {\n        this.options.map.onComplete.bind(this)();\n      }\n    }\n\n    if (this.table) {\n      this.table.render();\n      // On complete\n      if (!this.firstExecution && this.options.table.onComplete && this.options.table.onComplete.constructor === Function) {\n        this.options.table.onComplete.bind(this)();\n      }\n    }\n\n    // On complete\n    if (!this.firstExecution && this.options.onComplete && this.options.onComplete.constructor === Function) {\n      this.options.onComplete.bind(this)();\n    }\n    this.firstExecution = true;\n  }\n\n  setColumnDetails() {\n    const that = this;\n    if (that.rawData.length === 0) {\n      return;\n    }\n    const defaultColumns = {};\n\n    Object.keys(that.rawData[0]).forEach((k) => {\n      const patternNumber = /^[-+]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?$/;\n      const isNumber = patternNumber.test(that.rawData[0][k]);\n      defaultColumns[k] = {\n        title: utils.keyToTile(k),\n        filterMethod: isNumber ? 'compare' : 'field',\n        filterInputType: isNumber ? 'number' : this.options.columns[k] && this.options.columns[k].filterInputType ? this.options.columns[k].filterInputType : 'text',\n        sorting: true,\n      };\n\n      if (isNumber) {\n        defaultColumns[k].dataParse = (val) => parseFloat(val);\n      }\n    });\n    that.columnDetails = utils.extendRecursive(defaultColumns, this.options.columns);\n    // add isVirtual to columns details\n    Object.keys(that.columnDetails).forEach((k) => {\n      that.columnDetails[k].isVirtual = typeof that.columnDetails[k].virtual === 'function';\n    });\n  }\n}\n","/* eslint no-unused-vars: 0 */\nimport utils from './utils';\nimport defaultOptions from './defaultOptions';\nimport MapTable from './maptable';\n\nd3.maptable = function (target) {\n  let maptableObject;\n  const maptable = {};\n  const options = {\n    target,\n    columns: {},\n    data: {},\n    map: null,\n    filters: null,\n    table: null,\n  };\n\n  maptable.map = function (mapOptions = {}) {\n    if (!topojson) {\n      throw new Error('Maptable requires topojson.js');\n    }\n    if (typeof mapOptions.path !== 'string' && typeof mapOptions.pathData !== 'string') {\n      throw new Error('MapTable: map not provided');\n    }\n    options.map = mapOptions;\n    return maptable;\n  };\n\n  maptable.data = function (data) {\n    options.data.type = 'data';\n    options.data.value = data;\n    return maptable;\n  };\n\n  maptable.json = function (jsonPath, preFilter) {\n    options.data.type = 'json';\n    options.data.path = jsonPath;\n    options.data.preFilter = preFilter;\n    return maptable;\n  };\n\n  maptable.jsonData = function (jsonData) {\n    options.data.type = 'jsonData';\n    options.data.value = jsonData;\n    return maptable;\n  };\n\n  maptable.csv = function (csvPath, preFilter) {\n    options.data.type = 'csv';\n    options.data.path = csvPath;\n    options.data.preFilter = preFilter;\n    return maptable;\n  };\n\n  maptable.csvData = function (csvData) {\n    options.data.type = 'csvData';\n    options.data.value = csvData;\n    return maptable;\n  };\n\n  maptable.tsv = function (tsvPath, preFilter) {\n    options.data.type = 'tsv';\n    options.data.path = tsvPath;\n    options.data.preFilter = preFilter;\n    return maptable;\n  };\n\n  maptable.tsvData = function (tsvData) {\n    options.data.type = 'tsvData';\n    options.data.value = tsvData;\n    return maptable;\n  };\n\n  maptable.filters = function (filtersOptions = {}) {\n    options.filters = filtersOptions;\n    return maptable;\n  };\n\n  maptable.table = function (tableOptions = {}) {\n    options.table = tableOptions;\n    return maptable;\n  };\n\n  maptable.columns = function (columns = {}) {\n    options.columns = columns;\n    return maptable;\n  };\n\n  maptable.render = function (onComplete) {\n    if (typeof target !== 'string' || !document.querySelector(target)) {\n      throw new Error('MapTable: target not found');\n    }\n\n    if (!options.data || !options.data.type) {\n      throw new Error('MapTable: Please provide the path for your dataset data|json|jsonData|csv|csvData|tsv|tsvData');\n    }\n\n    if (options.map && !options.map.heatmap) options.map.heatmap = null;\n\n    if (options.map && options.map.markers === false) options.map.markers = null;\n\n    if (options.map && options.map.countries === false) options.map.countries = null;\n\n    if (!options.filters) options.filters = null;\n    options.onComplete = onComplete;\n\n    const customOptions = utils.extendRecursive(defaultOptions, options);\n\n    if (options.map && !options.map.markers) delete customOptions.map.markers;\n    if (options.map && !options.map.heatmap) delete customOptions.map.heatmap;\n    if (options.map && !options.map.title) delete customOptions.map.title;\n    if (options.map && !options.map.timezones) delete customOptions.map.timezones;\n    if (options.map && !options.map.night) delete customOptions.map.night;\n    if (!options.filters) delete customOptions.filters;\n    if (!options.table) delete customOptions.table;\n\n    maptableObject = new MapTable(target, customOptions);\n\n    // public functions\n    return {\n      render: () => maptableObject.render(),\n      loadState: (stateName, isJson) => maptableObject.loadState(stateName, isJson),\n      removeState: (stateName) => maptableObject.removeState(stateName),\n      saveState: (stateName, stateData) => maptableObject.saveState(stateName, stateData),\n      setTitleContent: (title) => {\n        maptableObject.options.map.title.content = () => title;\n      },\n      setData: (data) => {\n        maptableObject.options.data.type = 'data';\n        maptableObject.options.data.value = data;\n        maptableObject.options.rawData = data;\n        maptableObject.rawData = data;\n        maptableObject.data = data;\n        if (maptableObject.map) {\n          maptableObject.map.enrichData();\n        }\n      },\n      setNightDate: (date) => {\n        maptableObject.options.map.night.date = date;\n      },\n      setTimezonesDate: (date) => {\n        maptableObject.options.map.timezones.date = date;\n      },\n      getMapWidth: () => maptableObject.map.getWidth(),\n      getMapHeight: () => maptableObject.map.getHeight(),\n    };\n  };\n  return maptable;\n};\n\nif (!d3) {\n  throw new Error('Maptable requires d3.js');\n}\n\nexport default d3.maptable;\n"],"names":["appendOptions","select","options","defaultValue","forEach","f","option","document","createElement","setAttribute","value","innerText","text","appendChild","rangeToBool","el1","range","el2","parseInt","extendRecursive","dst","src","args","splice","call","arguments","toString","length","Object","keys","p","keyToTile","k","upperK","charAt","toUpperCase","slice","replace","sanitizeKey","toLowerCase","toNumber","str","resStr","Number","quantile","array","percentile","sort","a","b","index","result","Math","floor","i","fraction","uniqueValues","arr","l","indexOf","push","formatDate","d","zone","newDate","Date","getTime","toISOString","split","substr","isBlank","undefined","customSortOrders","days","months","customSortAsc","type","d1","d2","sortOrder","elem1","elem2","customSortOrder","customSortDesc","map","longitudeKey","latitudeKey","countryIdentifierKey","countryIdentifierType","zoom","saveState","exportSvg","exportSvgClient","ratioFromWidth","scaleHeight","scaleZoom","fitContentMargin","autoFitContent","tooltipClassName","countries","legend","attr","fill","stroke","heatmap","mask","weightByAttribute","weightByAttributeScale","circles","min","max","step","color","colorStrength","blur","borders","opacity","markers","r","title","fontSize","fontFamily","filters","table","className","collapseRowsBy","Legend","legendWidth","node","svg","append","getWidth","getHeight","buildIndice","domain","legendGradient","minNegative","maxNegative","midPercentNegative","round","midPercentPositive","indice","style","selectAll","toLocaleString","buildScale","val","isNaN","maxValue","minValue","positionDelta","position","width","height","padding","console","warn","window","btoa","buildWatermark","d3","xhr","res","mapWatermarkDelta","mime","x","y","dataUri","responseText","pos","mul_table","shg_table","processImage","img","canvas","radius","blurAlphaChannel","getElementById","HTMLImageElement","w","naturalWidth","h","naturalHeight","HTMLCanvasElement","context","getContext","clearRect","drawImage","processCanvasRGBA","processCanvasRGB","getImageDataFromCanvas","top_x","top_y","imageData","getImageData","e","Error","processImageDataRGBA","putImageData","pixels","data","yp","yi","yw","r_sum","g_sum","b_sum","a_sum","r_out_sum","g_out_sum","b_out_sum","a_out_sum","r_in_sum","g_in_sum","b_in_sum","a_in_sum","pr","pg","pb","pa","rbs","div","w4","widthMinus1","heightMinus1","radiusPlus1","sumFactor","stackStart","BlurStack","stack","next","stackEnd","stackIn","stackOut","mul_sum","shg_sum","g","processImageDataRGB","image","canvasRGBA","canvasRGB","imageDataRGBA","imageDataRGB","π","PI","radians","degrees","solarGeometricMeanAnomaly","centuries","solarGeometricMeanLongitude","solarEquationOfCenter","m","sin","solarTrueLongitude","solarApparentLongitude","meanObliquityOfEcliptic","obliquityCorrection","cos","solarDeclination","asin","eccentricityEarthOrbit","equationOfTime","tan","antipode","solarPosition","time","UTC","longitude","day","utc","GeoMap","maptable","jsonWorld","scale","transX","transY","containerSelector","target","container","querySelector","mapWrapper","existingMap","parentNode","insertBefore","removeChild","projection","geo","equirectangular","translate","rotate","precision","path","enrichData","zoomListener","behavior","scaleExtent","on","rescale","bind","tooltipMarkersNode","tooltipCountriesNode","layerGlobal","layerDefs","html","timezones","layerTimezones","layerCountries","night","layerNight","layerHeatmap","layerMarkers","watermark","Watermark","buildTitle","addExportSvgCapability","addEventListener","loadGeometries","rawData","parseFloat","latitude","coord","pow","offsetWidth","deltaHeight","filterCountries","objects","geometries","filter","buildCountries","buildHeatmap","buildNight","pathData","buildTimezone","lands","topojson","merge","disableMask","maskHeatmap","datum","imgHeatmap","mesh","bordersHeatmap","enter","circle","angle","maskNight","nightPath","cssBlur","userDate","date","startOfDay","getUTCFullYear","getUTCMonth","getUTCDate","solarPositionDated","origin","nightPathRight","nightPathLeft","disableSun","sunCoords","sunCircleRight","sunCircleXRight","sunCircleLeft","sunCircleXLeft","loadTimezone","JSON","parse","json","errGeoMap","jsonTimezones","err","dataTimezones","feature","features","maskTimezone","properties","places","insert","stringify","timezoneTexts","timezoneTextsUnique","Map","item","values","layerTimezonesText","scaleFontSize","utils","heatmapDataset","opts","lengthDataset","maxOpacityScale","linear","centralCircleOpacity","dataExtents","extent","userScale","log","canvasHeatmap","ctx","globalCompositeOperation","datumScale","getDatumScale","magnitudeScale","getMagnitudeScale","colorScale","beginPath","rect","fillStyle","closePath","colorMultiplier","aa","point","scaleOpacityDatum","StackBlur","dataUrl","toDataURL","remove","getHeatmapData","dataCountries","iso_a3","legendCountry","shouldRenderLegend","aggregate","allMtMapCountry","allMtMapMarker","dataByCountry","key","has","set","get","geoDatum","matchedCountry","rollupValue","setAttrValues","countryItem","getAllMtMapCountry","each","selection","attrKey","attrValue","scaleDomain","attrProperties","updateExtents","indiceChange","NaN","tooltip","activateTooltip","endOfDay","totalMilliseconds","currentTime","relativeTranslateX","transform","querySelectorAll","currentDate","Array","from","timezoneText","textContent","__data__","defaultGroupBy","dataMarkers","nest","entries","markerItem","markerObject","customTag","markerClassName","exit","transition","attrX","attrY","attrXDelta","attrYDelta","markerUpdate","getAllMtMapMarker","hor","ver","ratio","deltaMarker","currentWidth","currentHeight","realHeight","realWidth","diffMarginWidth","diffMarginHeight","titleContainer","bgColor","source","originalTranslation","newTx","newTy","encodedTranslation","defaultZoom","decodeTranslation","event","encodeTranslation","exportedData","removeState","self","defaultScaleTo","scaleType","transXY","getTransXYForLatLng","tx","ty","countryTransXY","getTransXYForCountry","tscale","maxTransX","maxTransY","minTransX","minTransY","scaleAttributes","firstExecution","lng","lat","coo","sc","country_code","currentCountryCode","currentCountryData","bounds","dx","dy","tr","dataset","mode","scaleToUse","rollup","groupedData","reduce","c","validData","groupedValues","exponent","sqrt","aggregatedValue","columnDetails","formatted","cellContent","positiveRanks","concat","v","negativeRanks","ranks","newValue","useNegative","scaleFunction","scaleNegativeFunction","copy","scaledValue","empty","originalValueRaw","originalValue","updateMarkers","updateCountries","updateNight","updateTimezones","updateTitle","updateHeatmap","fitContent","onRender","constructor","Function","content","showing","total","inlineFilters","getDescription","innerHTML","tooltipNode","tooltipContent","isCountry","mouseLeft","mouseTop","tooltipDelta","mapRect","getBoundingClientRect","mousePosition","mouse","left","top","targetRect","svgXml","XMLSerializer","serializeToString","saveAs","blob","Blob","form","submit","exportNode","exportButton","exportForm","Filters","criteria","show","arrayDiff","join","activeColumns","filtersHeaderNode","filtersResetNode","display","marginLeft","reset","filtersTitleNode","createTextNode","filtersBodyNode","filtersElementsNode","filtersNewNode","add","evt","preventDefault","possibleFilters","getPossibleFilters","filterName","create","replaceNode","rowNode","buildRow","replaceChild","render","toggle","filterIndex","rowNodes","output","filtersChildren","childNodes","element","filterOutput","filterMethod","filterRangeSelect","filterValueMin","filterValueMax","filterValue","criterion","row","decodeURIComponent","defaultCriteria","setFilters","outputArray","line","selectedIndex","separatorWord","that","minusButton","filterSeparator","filterNameSelect","oldFilterName","getAttribute","newFilterName","refresh","filterVerb","filterRange","handleRangeChange","filterInput","filterInputType","filterValueAnd","filterSelect","sortKeys","ascending","except","isVirtual","matched","fmt","dataParse","exportFilters","filterNameSelects","visibility","disableNewFilter","Table","sorting","defaultSorting","isArray","s","initialSorting","isSorting","header","body","nowrap","sortColumn","sortingRaw","sortingList","sortingData","encodedSorting","applySort","tableData","distinctBy","uniqueCollapsedRows","sortIndex","enableSeparator","isEndOfPrimarySort","rowClassName","tds","columnKey","column","virtual","dataCountIndicator","enabled","isSortGroupEnd","sortableColums","compareBool","d3SortMode","descending","d3CustomSortMode","filterType","currentCustomSortValues","cs","currentCustomSortOrder","order","sortValue","shiftKey","pop","unshift","reOrderSorting","to","increment","dataGroupSeparator","primarySort","MapTable","state","saveStateTimeout","removeStateTimeout","loadData","csv","tsv","preFilter","setColumnDetails","isIE","navigator","userAgent","appVersion","firstChild","buildComponenents","loadMapData","restoreState","stateName","isJson","parseState","parsedState","message","loadState","params","location","href","clearTimeout","updateState","stateData","setTimeout","newUrl","stateHash","stateValue","encodeURIComponent","history","pushState","filterData","onComplete","defaultColumns","patternNumber","isNumber","test","columns","maptableObject","mapOptions","jsonPath","jsonData","csvPath","csvData","tsvPath","tsvData","filtersOptions","tableOptions","customOptions","defaultOptions","setTitleContent","setData","setNightDate","setTimezonesDate","getMapWidth","getMapHeight"],"mappings":"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"}