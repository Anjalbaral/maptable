<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="maptable.css">
    <title>MapTable: Basic with Map, Filters and Table - minimal options</title>
</head>
<body>

<script src="d3.min.js" charset="utf-8"></script>
<script src="topojson.min.js"></script>
<script src="maptable.js"></script>

<div id="vizContainer" class='container'></div>

<script>
    var viz = d3.maptable('#vizContainer')
            .json('dir_data.json', (d) => {
              return parseInt(d.traf, 10) > 0;
            })
            .map({
              longitudeKey: 'lon',
              latitudeKey: 'lat',
              path: 'ne_110m_admin_0_countries.json',
              filterCountries: (country) => country.id !== 'AQ',
              heatmap: {
                opacityWeight: (d, dataset) => {
                  var extents = d3.extent(dataset, d => parseInt(d.traf, 10));
                  var scale = d3.scale.log()
                    .domain(extents)
                    .range([0.2, 1]);
                  return scale(parseInt(d.traf, 10));
                },
                maxOpacity: (count) => 0.006 * count + 0.3060,
                maxMagnitude: 90,
                borders: {
                  opacity: 0.2,
                },
              },
              markers: {
                attr: {
                  fill: '#FF0000',
                  r: '3'
                }
              }
            })
            .render();
</script>
</body>
</html>
